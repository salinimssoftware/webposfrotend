"use strict";(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[2573],{62106:(b,g,a)=>{a.d(g,{A:()=>u});var l=a(46543),c=a(64537);let u=(()=>{class d{}return d.\u0275fac=function(e){return new(e||d)},d.\u0275mod=c.oAB({type:d}),d.\u0275inj=c.cJS({imports:[l.m]}),d})()},49137:(b,g,a)=>{a.d(g,{C:()=>c});var l=a(64537);let c=(()=>{class u{transform(h,e,C){if(h)return e?h.filter(_=>{let f=_[C];const A=e.replace(/[^A-Z0-9]/gi,"").toLowerCase();if(-1!==(f?f.replace(/[^A-Z0-9]/gi,"").toLowerCase():"").indexOf(A))return _}):h}}return u.\u0275fac=function(h){return new(h||u)},u.\u0275pipe=l.Yjl({name:"searchData",type:u,pure:!1}),u})()},62573:(b,g,a)=>{a.r(g),a.d(g,{CouponIssueModule:()=>he});var l=a(88692),c=a(7976),u=a(20092),d=a(19102),h=a(91605),e=a(64537),C=a(79765),_=a(35732),f=a(67297),A=a(71180);let m=(()=>{class t{constructor(o,n,s){this.http=o,this.authService=n,this.state=s,this.couponCancelSubject=new C.xQ,this.couponCancelSubject$=this.couponCancelSubject.asObservable(),this.reloadCouponDetails=new C.xQ,this.reloadCouponDetails$=this.reloadCouponDetails.asObservable();const r=this.state.getGlobalSetting("apiUrl");r&&r.length>0&&(this.apiUrl=r)}getCoupons(){return this.http.get(this.apiUrl+"/getCoupons")}saveIssueCoupon(o,n){return this.http.post(this.apiUrl+"/issueCoupon",{mode:n,data:o})}getCouponByIssueNo(o){return this.http.get(this.apiUrl+`/getCouponByIssueNo?issueno=${o}`)}getActiveCouponDetails(o){return this.http.get(this.apiUrl+`/getCouponDetails/?issueno=${o}`)}getCancelledCouponDetails(o){return this.http.get(this.apiUrl+`/getCouponDetails/?issueno=${o}&isactive=0`)}cancelCoupon(o){return this.http.post(`${this.apiUrl}/cancelCoupon`,o)}}return t.\u0275fac=function(o){return new(o||t)(e.LFG(_.eN),e.LFG(f.e),e.LFG(A.q))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Z=a(14970),v=a(67311),x=a(28698);const T=["genericGridParty"];function y(t,i){if(1&t&&(e.TgZ(0,"button",22),e._uU(1," Save "),e.qZA()),2&t){const o=e.oxw();e.Q6J("disabled",!o.couponIssueForm.valid)}}function w(t,i){1&t&&(e.TgZ(0,"h5",23),e._uU(1,"Issue Coupon"),e.qZA())}function N(t,i){1&t&&(e.TgZ(0,"h5",23),e._uU(1,"Issued Coupon Detail"),e.qZA())}function S(t,i){1&t&&(e.TgZ(0,"span"),e._uU(1," Party is required. "),e.qZA())}function D(t,i){if(1&t&&(e.TgZ(0,"div",24),e.YNc(1,S,2,0,"span",25),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.couponIssueForm.get("ACNAME").hasError("required"))}}function P(t,i){1&t&&(e.TgZ(0,"span"),e._uU(1," From field value is required. "),e.qZA())}function F(t,i){if(1&t&&(e.TgZ(0,"div",24),e.YNc(1,P,2,0,"span",25),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.couponIssueForm.get("CouponNoFrom").hasError("required"))}}function M(t,i){1&t&&(e.TgZ(0,"span"),e._uU(1," To field value is required. "),e.qZA())}function U(t,i){if(1&t&&(e.TgZ(0,"div",24),e.YNc(1,M,2,0,"span",25),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.couponIssueForm.get("CouponNoTo").hasError("required"))}}function O(t,i){1&t&&(e.TgZ(0,"span"),e._uU(1," Effective date is required. "),e.qZA())}function q(t,i){if(1&t&&(e.TgZ(0,"div",24),e.YNc(1,O,2,0,"span",25),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngIf",o.couponIssueForm.get("IssueDate").hasError("required"))}}let J=(()=>{class t{constructor(o,n,s,r,p,ge){this.formBuilder=o,this.couponIssueService=n,this.spinnerService=s,this.router=r,this.alertService=p,this._activatedRoute=ge,this.salesTID="",this.mode="add",this.viewMode=!1,this.todayDate=(new Date).toJSON().slice(0,10),this.gridPopupSettingsForParty=new d.sG}ngOnInit(){this.initialiseCouponForm()}initialiseCouponForm(){console.log((new Date).toJSON().slice(10),"initialze date"),this.couponIssueForm=this.formBuilder.group({ACNAME:["",[u.kI.required]],ACID:["",[u.kI.required]],CouponNoFrom:[null,[u.kI.required]],CouponNoTo:[null,[u.kI.required]],IssueDate:[this.todayDate,[u.kI.required]],Guid:[""]}),this.couponIssueForm.patchValue({Guid:h()}),this.disableFieldForCoupon(),this.patchCouponValues()}patchCouponValues(){if(this._activatedRoute.snapshot.params.couponNo){let o=this._activatedRoute.snapshot.params.couponNo;this.spinnerService.show("Getting data, Please wait..."),this.couponIssueService.getCouponByIssueNo(o).subscribe(n=>{this.couponIssueForm.patchValue({ACNAME:n.ACNAME,ACID:n.ACID,CouponNoFrom:n.CouponNoFrom,CouponNoTo:n.CouponNoTo,IssueDate:n.IssueDate.substring(0,10)}),this.spinnerService.hide()},n=>{this.spinnerService.hide(),this.alertService.error(n.error)})}else this.mode="add"}disableFieldForCoupon(){this._activatedRoute.snapshot.params.mode&&"view"===this._activatedRoute.snapshot.params.mode&&(this.mode="view",this.viewMode=!0,this.couponIssueForm.get("ACNAME").disable(),this.couponIssueForm.get("CouponNoFrom").disable(),this.couponIssueForm.get("CouponNoTo").disable(),this.couponIssueForm.get("IssueDate").disable())}onSubmit(){this.spinnerService.show("Data is Saving ..."),this.couponIssueService.saveIssueCoupon(this.couponIssueForm.value,this.mode).subscribe(o=>{"ok"==o.status?(this.spinnerService.hide(),this.alertService.success(o.result),this.couponIssueForm.reset(),this.couponIssueForm.patchValue({Guid:h()}),this.router.navigate(["./pages/masters/coupon-issue"])):(this.alertService.info(o.result),this.spinnerService.hide())},o=>{this.spinnerService.hide(),this.alertService.info(o.error)})}getPartyList(){this.gridPopupSettingsForParty={title:"Party List",apiEndpoints:"/getAccountPagedListByMapId/Master/Customer",defaultFilterIndex:0,useDefinefilterValue:"",columns:[{key:"ACNAME",title:"A/C NAME",hidden:!1,noSearch:!1},{key:"TYPE",title:"TYPE",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"VATNO",title:"VAT NO",hidden:!1,noSearch:!1}]}}partyEnterCommand(o){this.getPartyList(),this.genericGridParty.show()}onPartySelected(o){this.couponIssueForm.patchValue({ACID:o.ACID,ACNAME:o.ACNAME})}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(u.qu),e.Y36(m),e.Y36(Z.V),e.Y36(c.F0),e.Y36(v.c),e.Y36(c.gz))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-coupon-issue-form"]],viewQuery:function(o,n){if(1&o&&e.Gf(T,5),2&o){let s;e.iGM(s=e.CRH())&&(n.genericGridParty=s.first)}},decls:42,vars:13,consts:[[1,"sticky-top","row"],[1,"col-md-4"],[1,"col-md-8"],[1,"row","pull-right","mx-2"],[3,"formGroup","ngSubmit"],["type","submit","class","btn btn-info","style","font-size: 12px",3,"disabled",4,"ngIf"],["type","button","routerLink","/pages/masters/coupon-issue",1,"btn","btn-info",2,"font-size","12px"],[1,"card"],[1,"card-header"],["class","page-title",4,"ngIf"],[1,"card-body"],[1,"form-horizontal",2,"margin-top","15px",3,"formGroup","ngSubmit"],[1,"form-group","row"],[1,"col-sm-3","form-control-label",2,"margin-left","-12px"],[1,"col-sm-7"],["type","text","autocomplete","off","formControlName","ACNAME","placeholder","Press Enter to select...",1,"form-control",2,"height","4vh",3,"keydown.enter"],["class","text-danger",4,"ngIf"],["type","number","autocomplete","off","formControlName","CouponNoFrom",1,"form-control",2,"height","4vh",3,"readOnly"],["type","number","autocomplete","off","formControlName","CouponNoTo",1,"form-control",2,"height","4vh",3,"readOnly"],["type","date","formControlName","IssueDate",1,"form-control",2,"color","black",3,"max"],[3,"popupsettings","onItemDoubleClick"],["genericGridParty",""],["type","submit",1,"btn","btn-info",2,"font-size","12px",3,"disabled"],[1,"page-title"],[1,"text-danger"],[4,"ngIf"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5"),e._uU(3,"Coupon Issue"),e.qZA()(),e.TgZ(4,"div",2)(5,"div",3)(6,"form",4),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.YNc(7,y,2,1,"button",5),e.TgZ(8,"button",6),e._uU(9," Back "),e.qZA()()()()(),e.TgZ(10,"div",7)(11,"div",8),e.YNc(12,w,2,0,"h5",9),e.YNc(13,N,2,0,"h5",9),e.qZA(),e.TgZ(14,"div",10)(15,"form",11),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.TgZ(16,"div",12)(17,"label",13),e._uU(18,"Party Name: "),e.qZA(),e.TgZ(19,"div",14)(20,"input",15),e.NdJ("keydown.enter",function(r){return n.partyEnterCommand(r)}),e.qZA(),e.YNc(21,D,2,1,"div",16),e.qZA()(),e.TgZ(22,"div",12)(23,"label",13),e._uU(24,"From:"),e.qZA(),e.TgZ(25,"div",14),e._UZ(26,"input",17),e.YNc(27,F,2,1,"div",16),e.qZA()(),e.TgZ(28,"div",12)(29,"label",13),e._uU(30,"To:"),e.qZA(),e.TgZ(31,"div",14),e._UZ(32,"input",18),e.YNc(33,U,2,1,"div",16),e.qZA()(),e.TgZ(34,"div",12)(35,"label",13),e._uU(36,"Issue Date:"),e.qZA(),e.TgZ(37,"div",14),e._UZ(38,"input",19),e.YNc(39,q,2,1,"div",16),e.qZA()()()()(),e.TgZ(40,"generic-popup-grid",20,21),e.NdJ("onItemDoubleClick",function(r){return n.onPartySelected(r)}),e.qZA()),2&o&&(e.xp6(6),e.Q6J("formGroup",n.couponIssueForm),e.xp6(1),e.Q6J("ngIf",!n.viewMode),e.xp6(5),e.Q6J("ngIf","add"==n.mode),e.xp6(1),e.Q6J("ngIf","view"==n.mode),e.xp6(2),e.Q6J("formGroup",n.couponIssueForm),e.xp6(6),e.Q6J("ngIf",!n.couponIssueForm.controls.ACNAME.valid&&(null==n.couponIssueForm.controls.ACNAME?null:n.couponIssueForm.controls.ACNAME.touched)),e.xp6(5),e.Q6J("readOnly","view"==n.mode),e.xp6(1),e.Q6J("ngIf",!n.couponIssueForm.controls.CouponNoFrom.valid&&(null==n.couponIssueForm.controls.CouponNoFrom?null:n.couponIssueForm.controls.CouponNoFrom.touched)),e.xp6(5),e.Q6J("readOnly","view"==n.mode),e.xp6(1),e.Q6J("ngIf",!n.couponIssueForm.controls.CouponNoTo.valid&&(null==n.couponIssueForm.controls.CouponNoTo?null:n.couponIssueForm.controls.CouponNoTo.touched)),e.xp6(5),e.Q6J("max",n.todayDate),e.xp6(1),e.Q6J("ngIf",!n.couponIssueForm.controls.IssueDate.valid&&(null==n.couponIssueForm.controls.IssueDate?null:n.couponIssueForm.controls.IssueDate.touched)),e.xp6(1),e.Q6J("popupsettings",n.gridPopupSettingsForParty))},dependencies:[l.O5,c.rH,u._Y,u.Fj,u.wV,u.JJ,u.JL,u.sg,u.u,x.Zl],styles:[".card[_ngcontent-%COMP%]{margin:10px 30px 0 300px!important;width:60%}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{border:1px solid #cbcbcb;border-radius:3px;height:4vh;color:#000}label[_ngcontent-%COMP%]{height:25px;font-size:14px}.col-sm-7[_ngcontent-%COMP%]{padding-left:1px}.form-control[_ngcontent-%COMP%]{font-size:14px}"]}),t})();var I=a(72533),k=a(49137);function L(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"tr")(1,"td",22),e._uU(2),e.qZA(),e.TgZ(3,"td",23),e._uU(4),e.qZA(),e.TgZ(5,"td",24),e._uU(6),e.qZA(),e.TgZ(7,"td",24),e._uU(8),e.qZA(),e.TgZ(9,"td",25),e._uU(10),e.qZA(),e.TgZ(11,"td",25),e._uU(12),e.qZA(),e.TgZ(13,"td",26)(14,"button",27),e.NdJ("click",function(){const r=e.CHM(o).$implicit,p=e.oxw(2);return e.KtG(p.onView(r))}),e._uU(15," View "),e.qZA(),e.TgZ(16,"button",27),e.NdJ("click",function(){const r=e.CHM(o).$implicit,p=e.oxw(2);return e.KtG(p.onDetails(r))}),e._uU(17," Details "),e.qZA()()()}if(2&t){const o=i.$implicit,n=i.index;e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(o.ACNAME),e.xp6(2),e.Oqu(o.CouponNoFrom),e.xp6(2),e.Oqu(o.CouponNoTo),e.xp6(2),e.Oqu(o.IssueDate.substring(0,10)),e.xp6(2),e.Oqu(o.STATUS)}}const V=function(t,i,o){return{itemsPerPage:t,currentPage:i,totalItems:o}};function E(t,i){if(1&t&&(e.ynx(0),e.YNc(1,L,18,6,"tr",21),e.ALo(2,"paginate"),e.ALo(3,"searchData"),e.BQk()),2&t){const o=e.oxw();e.xp6(1),e.Q6J("ngForOf",e.xi3(2,1,e.Dn7(3,4,o.couponIssueList,o.filter,"ACNAME"),e.kEZ(8,V,o.itemsPerPage,o.currentPage,o.totalCount)))}}function Q(t,i){1&t&&(e.ynx(0),e.TgZ(1,"tr")(2,"td",28)(3,"div",29),e._uU(4,"Coupon Issue information are unavailable."),e.qZA()()(),e.BQk())}function Y(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"div",30)(1,"div",31)(2,"div",32)(3,"pagination-controls",33),e.NdJ("pageChange",function(s){e.CHM(o);const r=e.oxw();return e.KtG(r.issueCouponPagination(s))}),e.qZA()()()()}}let B=(()=>{class t{constructor(o,n,s,r){this.router=o,this.alertService=n,this.loadingService=s,this.couponIssueService=r,this.couponIssueList=[],this.currentPage=1,this.itemsPerPage=20,this.isLoader=!0,this.loadingService.show("Loading data...."),this.couponIssueService.getCoupons().subscribe(p=>{p&&(this.loadingService.hide(),this.couponIssueList=p.data)},p=>{this.loadingService.hide(),this.alertService.error(p.error)})}ngOnInit(){}addCouponIssue(){try{this.router.navigate(["./pages/masters/coupon-issue/add-coupon-issue",{mode:"add",returnUrl:this.router.url}])}catch(o){this.alertService.error(o)}}onView(o){try{this.router.navigate(["./pages/masters/coupon-issue/add-coupon-issue",{couponNo:o.IssueNo,mode:"view",returnUrl:this.router.url}])}catch(n){this.alertService.error(n)}}onDetails(o){try{this.router.navigate(["./pages/masters/coupon-issue/view-coupon-details",{acName:o.ACNAME,couponNo:o.IssueNo,mode:"view",returnUrl:this.router.url}])}catch(n){this.alertService.error(n)}}issueCouponPagination(o){this.isLoader=!0,this.currentPage=o;const n=this;window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{n.isLoader=!1},500)}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(c.F0),e.Y36(v.c),e.Y36(Z.V),e.Y36(m))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-coupon-issue-list"]],decls:41,vars:12,consts:[[1,"row","col-md-12"],[1,"col-md-4"],[1,"col-md-8"],["routerLink","/pages/dashboard",1,"btn","btn-info","pull-right",2,"font-size","12px"],[1,"btn","btn-info","pull-right",2,"font-size","12px",3,"click"],[1,"row",2,"align-items","center"],[1,"col-md-12","col-sm-8",2,"margin-top","0.5rem"],[1,"card",2,"margin","auto","width","85%"],[1,"card-header"],[2,"width","25%"],["type","search","placeholder","Search...","name","filter","autocomplete","off",1,"form-control",2,"height","1.5rem","font-size","13px",3,"ngModel","ngModelChange"],[1,"card-body"],[1,"table","table-striped"],[2,"position","sticky","top","0","line-height","1.5rem"],["scope","col",2,"width","3%"],["scope","col",2,"width","13%"],["scope","col",2,"width","8%"],["scope","col",2,"width","10%"],["scope","col",2,"text-align","center","width","15%"],[4,"ngIf"],["class","card-footer","style","padding:5px",4,"ngIf"],[4,"ngFor","ngForOf"],[2,"width","3%"],[2,"width","13%"],[2,"width","8%"],[2,"width","10%"],[2,"width","15%","text-align","center"],["type","button","data-toggle","modal",1,"btn","btn-sm","btn-info","mr-1","btn-sm",2,"width","60px",3,"click"],["colspan","7"],[1,"font-weight-bold"],[1,"card-footer",2,"padding","5px"],[1,"pagination"],[2,"margin","auto"],[1,"my-pagination",3,"pageChange"]],template:function(o,n){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5"),e._uU(3,"Coupon Issue"),e.qZA()(),e.TgZ(4,"div",2)(5,"button",3),e._uU(6,"Back"),e.qZA(),e.TgZ(7,"button",4),e.NdJ("click",function(){return n.addCouponIssue()}),e._uU(8,"Issue Coupon "),e.qZA()()(),e.TgZ(9,"div",5)(10,"div",6)(11,"div",7)(12,"div",8)(13,"span"),e._uU(14,"Issued Coupon"),e.qZA(),e.TgZ(15,"div",9)(16,"input",10),e.NdJ("ngModelChange",function(r){return n.filter=r}),e.qZA()()(),e.TgZ(17,"div",11)(18,"table",12)(19,"thead")(20,"tr",13)(21,"th",14),e._uU(22,"S.N"),e.qZA(),e.TgZ(23,"th",15),e._uU(24,"Party Name"),e.qZA(),e.TgZ(25,"th",16),e._uU(26,"Coupon From"),e.qZA(),e.TgZ(27,"th",16),e._uU(28,"Coupon To"),e.qZA(),e.TgZ(29,"th",17),e._uU(30,"Issue Date"),e.qZA(),e.TgZ(31,"th",17),e._uU(32,"Status"),e.qZA(),e.TgZ(33,"th",18),e._uU(34,"Action"),e.qZA()()(),e.TgZ(35,"tbody"),e.YNc(36,E,4,12,"ng-container",19),e.YNc(37,Q,5,0,"ng-container",19),e.ALo(38,"searchData"),e.qZA()()(),e.YNc(39,Y,4,0,"div",20),e.ALo(40,"searchData"),e.qZA()()()),2&o&&(e.xp6(16),e.Q6J("ngModel",n.filter),e.xp6(20),e.Q6J("ngIf",n.couponIssueList&&n.couponIssueList.length>0),e.xp6(1),e.Q6J("ngIf",n.couponIssueList&&0===e.Dn7(38,4,n.couponIssueList,n.filter,"ACNAME").length),e.xp6(2),e.Q6J("ngIf",n.couponIssueList&&e.Dn7(40,8,n.couponIssueList,n.filter,"ACNAME").length>n.itemsPerPage))},dependencies:[l.sg,l.O5,c.rH,u.Fj,u.JJ,u.On,I.LS,I._s,k.C],styles:[".card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.card-header[_ngcontent-%COMP%]:after{display:none}.card-body[_ngcontent-%COMP%]{padding:5px!important;max-height:675px!important}.card-footer[_ngcontent-%COMP%]{height:6vh}.main-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin:60px 0}.scroll-touch[_ngcontent-%COMP%]{-webkit-overflow-scrolling:touch!important}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.1rem!important}.sticky-top[_ngcontent-%COMP%]{margin-top:60px;height:100vh}tbody[_ngcontent-%COMP%]{display:block;height:59vh;overflow:auto}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}th[_ngcontent-%COMP%]{font-size:15px}td[_ngcontent-%COMP%]{font-size:13px}.btn-sm[_ngcontent-%COMP%]{line-height:3px}.card-header[_ngcontent-%COMP%]{padding:10px 20px}.searchBy[_ngcontent-%COMP%]{font-size:13px;margin-left:18rem}"]}),t})();function G(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"h5",4),e._uU(4,"Remarks Entry"),e.qZA(),e.TgZ(5,"div",5)(6,"button",6),e.NdJ("click",function(){e.CHM(o);const s=e.oxw();return e.KtG(s.submit())}),e._uU(7," SAVE "),e.qZA(),e.TgZ(8,"button",7),e.NdJ("click",function(){e.CHM(o);const s=e.oxw();return e.KtG(s.closeDialog())}),e._uU(9," CANCEL "),e.qZA()()(),e.TgZ(10,"div",8)(11,"div",9)(12,"label",10),e._uU(13,"Remarks of Cancel Coupon:"),e.qZA(),e.TgZ(14,"div",11)(15,"textarea",12),e.NdJ("ngModelChange",function(s){e.CHM(o);const r=e.oxw();return e.KtG(r.remarks=s)}),e.qZA()()()()()()}if(2&t){const o=e.oxw();e.xp6(15),e.Q6J("ngModel",o.remarks)}}let R=(()=>{class t{constructor(o,n){this.alertService=o,this.couponService=n,this.isActive=!1,this.remarks=""}ngOnInit(){this.couponService.couponCancelSubject$.subscribe(o=>{this.couponData=o})}show(){this.isActive=!0}closeDialog(){this.isActive=!1}submit(){console.log(this.remarks),this.remarks?(this.couponData.Remarks=this.remarks,this.couponService.cancelCoupon({mode:"cancel",data:this.couponData}).subscribe(n=>{console.log(n),this.couponService.reloadCouponDetails.next(),this.closeDialog()})):this.alertService.error("Remarks is mandatory")}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(v.c),e.Y36(m))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-coupon-cancel-popup"]],decls:1,vars:1,consts:[["class","customer_container popup",4,"ngIf"],[1,"customer_container","popup"],[1,"card"],[1,"card-header"],[1,"page-title"],[1,"button-group"],["title","Save","type","submit",1,"btn","btn-info",2,"margin-right","2px",3,"click"],["type","button","title","Cancel",1,"btn","btn-info",3,"click"],[1,"card-body"],[1,"form-group","row"],[1,"col-md-3","form-control-label"],[1,"col-md-7"],[1,"form-control",2,"width","100%",3,"ngModel","ngModelChange"]],template:function(o,n){1&o&&e.YNc(0,G,16,1,"div",0),2&o&&e.Q6J("ngIf",n.isActive)},dependencies:[l.O5,u.Fj,u.JJ,u.On],styles:[".popup[_ngcontent-%COMP%]{position:absolute;z-index:9999;width:50%;top:300px;left:50%;transform:translate(-50%,-50%)}"]}),t})();const z=["couponPopup"];function j(t,i){if(1&t&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&t){const o=e.oxw();e.xp6(1),e.hij("",o.acName,"'s Issued Coupons")}}function $(t,i){if(1&t&&e._uU(0),2&t){const o=e.oxw();e.hij("",o.acName,"'s Cancelled Coupons")}}function H(t,i){1&t&&(e.TgZ(0,"th",17),e._uU(1,"Cancelled Date"),e.qZA())}function K(t,i){1&t&&(e.TgZ(0,"th",17),e._uU(1,"Remarks"),e.qZA())}function W(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"th",17),e._uU(1,"Select All \xa0"),e.TgZ(2,"input",23),e.NdJ("change",function(s){e.CHM(o);const r=e.oxw();return e.KtG(r.selectAll(s))}),e.qZA()()}if(2&t){const o=e.oxw();e.xp6(2),e.Q6J("disabled",o.everyCouponIsUsed)}}function X(t,i){1&t&&(e.ynx(0),e._uU(1,"No active coupons available"),e.BQk())}function ee(t,i){1&t&&(e.ynx(0),e._uU(1,"No cancelled coupons available"),e.BQk())}function oe(t,i){if(1&t&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&t){const o=e.oxw().$implicit;e.xp6(1),e.Oqu(null==o.CancelledDate?null:o.CancelledDate.slice(0,10))}}function te(t,i){if(1&t&&(e.TgZ(0,"td",25),e._uU(1),e.qZA()),2&t){const o=e.oxw().$implicit;e.xp6(1),e.Oqu(o.CancelledRemarks)}}function ne(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"input",29),e.NdJ("change",function(s){e.CHM(o);const r=e.oxw().$implicit,p=e.oxw();return e.KtG(p.changeSingleCheckBox(s,r,r.CouponNo))}),e.qZA()}if(2&t){const o=e.oxw().$implicit,n=e.oxw();e.Q6J("disabled",o.IsUsed)("ngModel",n.allChecked)}}function ie(t,i){if(1&t&&(e.ynx(0),e.TgZ(1,"tr")(2,"td",24),e._uU(3),e.qZA(),e.TgZ(4,"td",25),e._uU(5),e.qZA(),e.YNc(6,oe,2,1,"td",26),e.YNc(7,te,2,1,"td",26),e.TgZ(8,"td",27),e._uU(9),e.qZA(),e.TgZ(10,"td",24),e.YNc(11,ne,1,2,"input",28),e.qZA()(),e.BQk()),2&t){const o=i.$implicit,n=i.index,s=e.oxw();e.xp6(3),e.Oqu(n+1),e.xp6(2),e.Oqu(o.IssueDate.slice(0,10)),e.xp6(1),e.Q6J("ngIf",s.cancelCouponView),e.xp6(1),e.Q6J("ngIf",s.cancelCouponView),e.xp6(2),e.Oqu(o.CouponNo),e.xp6(2),e.Q6J("ngIf",!s.cancelCouponView)}}function se(t,i){if(1&t){const o=e.EpF();e.TgZ(0,"div",30)(1,"div",31)(2,"div",32)(3,"pagination-controls",33),e.NdJ("pageChange",function(s){e.CHM(o);const r=e.oxw();return e.KtG(r.issueCouponPagination(s))}),e.qZA()()()()}}const re=function(){return["/pages","masters","coupon-issue"]},ue=function(t,i,o){return{itemsPerPage:t,currentPage:i,totalItems:o}},ae=[{path:"",component:B},{path:"add-coupon-issue",component:J},{path:"view-coupon-details",component:(()=>{class t{constructor(o,n,s,r){this.couponIssueService=o,this._activatedRoute=n,this.spinnerService=s,this.alertService=r,this.couponDetailsArray=[],this.isLoader=!0,this.currentPage=1,this.itemsPerPage=20,this.everyCouponIsUsed=!1,this.toBeSavedArray=[],this.allChecked=!1,this.cancelCouponView=!1,this.isNotUsedArray=[]}ngOnInit(){this.initializeComponent(),this.reloadSubscription=this.couponIssueService.reloadCouponDetails$.subscribe(o=>{this.cancelCouponView?(this.getInactiveCouponDetails(),this.cancelCouponView=!0):(this.getActiveCouponDetails(),this.cancelCouponView=!1)}),this.getActiveCouponDetails()}showOnlyInactiveCoupons(o){this.toBeSavedArray=[],this.allChecked=!1,o.target.checked?(this.getInactiveCouponDetails(),this.cancelCouponView=!0):o.target.checked||(this.getActiveCouponDetails(),this.cancelCouponView=!1)}selectAll(o){o.target.checked?(this.toBeSavedArray=this.isNotUsedArray.map(n=>({Series:n.Series,CouponNo:n.CouponNo})),this.allChecked=!0):o.target.checked||(this.toBeSavedArray=[],this.allChecked=!1)}initializeComponent(){this.allChecked=!1,this._activatedRoute.snapshot.params.couponNo&&(this.issueNo=this._activatedRoute.snapshot.params.couponNo,this.acName=this._activatedRoute.snapshot.params.acName,this.spinnerService.show("Getting data, Please wait..."))}getActiveCouponDetails(){this.activeCouponSubscription=this.couponIssueService.getActiveCouponDetails(this.issueNo).subscribe(o=>{this.couponDetailsArray=o.data,this.isNotUsedArray=o.data.filter(n=>1!==n.IsUsed),0===this.isNotUsedArray.length&&(this.everyCouponIsUsed=!0),this.totalCount=o.totalCount,this.spinnerService.hide()},o=>{this.spinnerService.hide(),this.alertService.error(o.error)})}getInactiveCouponDetails(){this.inactiveCouponSubscription=this.couponIssueService.getCancelledCouponDetails(this.issueNo).subscribe(o=>{this.couponDetailsArray=o.data,this.totalCount=o.totalCount,this.spinnerService.hide()},o=>{this.spinnerService.hide(),this.alertService.error(o.error)})}issueCouponPagination(o){this.isLoader=!0,this.currentPage=o;const n=this;window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{n.isLoader=!1},500)}changeSingleCheckBox(o,n,s){o.target.checked?this.toBeSavedArray.push({Series:n.Series,CouponNo:n.CouponNo}):o.target.checked||(this.toBeSavedArray=this.toBeSavedArray.filter(r=>r.CouponNo!==s))}onProceed(){if(0===this.toBeSavedArray.length)return void this.alertService.warning("No coupon is selected");this.couponPopupComponent.show();const o={CancelDate:(new Date).toJSON().slice(0,10),CouponList:this.toBeSavedArray};this.couponIssueService.couponCancelSubject.next(o)}ngOnDestroy(){this.activeCouponSubscription&&this.activeCouponSubscription.unsubscribe(),this.inactiveCouponSubscription&&this.inactiveCouponSubscription.unsubscribe(),this.reloadSubscription&&this.reloadSubscription.unsubscribe()}}return t.\u0275fac=function(o){return new(o||t)(e.Y36(m),e.Y36(c.gz),e.Y36(Z.V),e.Y36(v.c))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-view-coupon-details"]],viewQuery:function(o,n){if(1&o&&e.Gf(z,5),2&o){let s;e.iGM(s=e.CRH())&&(n.couponPopupComponent=s.first)}},decls:42,vars:18,consts:[[1,"row","col-md-12"],[1,"col-md-4"],[1,"col-md-8"],["type","button",1,"btn","btn-info","pull-right",2,"font-size","12px",3,"click"],["type","button",1,"btn","btn-info","pull-right",2,"font-size","12px",3,"routerLink"],["couponPopup",""],[1,"row",2,"align-items","center"],[1,"col-md-12","col-sm-8",2,"margin-top","0.5rem"],[1,"card",2,"margin","auto","width","85%"],[1,"card-header"],[4,"ngIf","ngIfElse"],["inactive",""],["type","checkbox",2,"cursor","pointer",3,"change"],[1,"card-body","over"],[1,"table","table-striped"],[2,"top","0","line-height","1.5rem"],["scope","col",2,"width","3%"],["scope","col",2,"width","8%"],["scope","col","style","width:8%",4,"ngIf"],[4,"ngIf"],[2,"max-height","85vh","overflow","auto"],[4,"ngFor","ngForOf"],["class","card-footer","style","padding:5px",4,"ngIf"],["type","checkbox",2,"cursor","pointer",3,"disabled","change"],[2,"width","3%"],[2,"width","8%"],["style","width:8%",4,"ngIf"],[2,"width","13%"],["type","checkbox","style","cursor:pointer;margin-inline-start:75px;",3,"disabled","ngModel","change",4,"ngIf"],["type","checkbox",2,"cursor","pointer","margin-inline-start","75px",3,"disabled","ngModel","change"],[1,"card-footer",2,"padding","5px"],[1,"pagination"],[2,"margin","auto"],[1,"my-pagination",3,"pageChange"]],template:function(o,n){if(1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h5"),e._uU(3,"Coupon Details"),e.qZA()(),e.TgZ(4,"div",2)(5,"button",3),e.NdJ("click",function(){return n.onProceed()}),e._uU(6,"Cancel Coupon "),e.qZA(),e.TgZ(7,"button",4),e._uU(8,"Back "),e.qZA()()(),e._UZ(9,"app-coupon-cancel-popup",null,5),e.TgZ(11,"div",6)(12,"div",7)(13,"div",8)(14,"div",9),e.YNc(15,j,2,1,"span",10),e.YNc(16,$,1,1,"ng-template",null,11,e.W1O),e.TgZ(18,"div")(19,"input",12),e.NdJ("change",function(r){return n.showOnlyInactiveCoupons(r)}),e.qZA(),e._uU(20," \xa0 "),e.TgZ(21,"span"),e._uU(22,"Show Cancelled Coupons"),e.qZA()()(),e.TgZ(23,"div",13)(24,"table",14)(25,"thead")(26,"tr",15)(27,"th",16),e._uU(28,"SN"),e.qZA(),e.TgZ(29,"th",17),e._uU(30,"Issue Date"),e.qZA(),e.YNc(31,H,2,0,"th",18),e.YNc(32,K,2,0,"th",18),e.TgZ(33,"th",16),e._uU(34,"Coupon No."),e.qZA(),e.YNc(35,W,3,1,"th",18),e.qZA()(),e.YNc(36,X,2,0,"ng-container",19),e.YNc(37,ee,2,0,"ng-container",19),e.TgZ(38,"tbody",20),e.YNc(39,ie,12,6,"ng-container",21),e.ALo(40,"paginate"),e.qZA()()(),e.YNc(41,se,4,0,"div",22),e.qZA()()()),2&o){const s=e.MAs(17);e.xp6(7),e.Q6J("routerLink",e.DdM(13,re)),e.xp6(8),e.Q6J("ngIf",!n.cancelCouponView)("ngIfElse",s),e.xp6(16),e.Q6J("ngIf",n.cancelCouponView),e.xp6(1),e.Q6J("ngIf",n.cancelCouponView),e.xp6(3),e.Q6J("ngIf",!n.cancelCouponView),e.xp6(1),e.Q6J("ngIf",0===n.couponDetailsArray.length&&!n.cancelCouponView),e.xp6(1),e.Q6J("ngIf",0===n.couponDetailsArray.length&&n.cancelCouponView),e.xp6(2),e.Q6J("ngForOf",e.xi3(40,10,n.couponDetailsArray,e.kEZ(14,ue,n.itemsPerPage,n.currentPage,n.totalCount))),e.xp6(2),e.Q6J("ngIf",n.couponDetailsArray.length>n.itemsPerPage)}},dependencies:[l.sg,l.O5,c.rH,u.Wl,u.JJ,u.On,I.LS,R,I._s],styles:[".card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.over[_ngcontent-%COMP%]{max-height:65vh;overflow:auto}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:0}"]}),t})()}];let ce=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[c.Bz.forChild(ae),c.Bz]}),t})();var pe=a(46543),le=a(54536),de=a(62106);let he=(()=>{class t{}return t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({providers:[m],imports:[l.ez,ce,pe.m,le.Is,de.A,u.u5]}),t})()}}]);