"use strict";(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[7051],{89952:(x,p,h)=>{h.d(p,{g:()=>u});var t=h(64537);let u=(()=>{class a{transform(r){return r||(r=0),Number(r).toFixed(2)}}return a.\u0275fac=function(r){return new(r||a)},a.\u0275pipe=t.Yjl({name:"twoDigitNumber",type:a,pure:!0}),a})()},28096:(x,p,h)=>{h.d(p,{C:()=>u});var t=h(64537);let u=(()=>{class a{transform(r,_,T){if(r)return _?r.filter(s=>{if("BATCH"==T){const g=_.replace(/[^A-Z0-9]/gi,"").toLowerCase();if(-1!==(s.BATCH?s.BATCH.replace(/[^A-Z0-9]/gi,"").toLowerCase():"").indexOf(g))return s}else{const g=_.replace(/[^A-Z0-9]/gi,"").toLowerCase();if(-1!==(s.BATCHCODE?s.BATCHCODE.replace(/[^A-Z0-9]/gi,"").toLowerCase():"").indexOf(g))return s}}):r}}return a.\u0275fac=function(r){return new(r||a)},a.\u0275pipe=t.Yjl({name:"searchData",type:a,pure:!1}),a})()},37051:(x,p,h)=>{h.d(p,{K:()=>y});var t=h(64537),u=h(53074),a=h(87584),d=h(88692),r=h(20092),_=h(89952),T=h(28096);const s=["BatchEntry"],g=["SearchBox"];function m(i,c){if(1&i&&(t.TgZ(0,"option",31),t._uU(1),t.qZA()),2&i){const e=c.$implicit;t.Q6J("ngValue",e),t.xp6(1),t.Oqu(e.ALTUNIT)}}function A(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"div",17),t._uU(2," New Batch : "),t.qZA(),t.TgZ(3,"div",18)(4,"table",19)(5,"tr",11)(6,"th"),t._uU(7,"Batch No."),t.qZA(),t.TgZ(8,"th"),t._uU(9,"MFG"),t.qZA(),t.TgZ(10,"th"),t._uU(11,"Expiry"),t.qZA(),t.TgZ(12,"th"),t._uU(13,"Unit"),t.qZA(),t.TgZ(14,"th"),t._uU(15,"Cost Price"),t.qZA(),t.TgZ(16,"th"),t._uU(17,"Sell Price"),t.qZA(),t._UZ(18,"th"),t.qZA(),t.TgZ(19,"tr",20)(20,"td",21,22)(22,"input",23),t.NdJ("ngModelChange",function(o){t.CHM(e);const l=t.oxw();return t.KtG(l.BatchObj.BCODE=o)}),t.qZA()(),t.TgZ(23,"td",21)(24,"input",24),t.NdJ("ngModelChange",function(o){t.CHM(e);const l=t.oxw();return t.KtG(l.BatchObj.MFGDATE=o)}),t.qZA()(),t.TgZ(25,"td",21)(26,"input",24),t.NdJ("ngModelChange",function(o){t.CHM(e);const l=t.oxw();return t.KtG(l.BatchObj.EXPIRY=o)}),t.qZA()(),t.TgZ(27,"td",21)(28,"select",25),t.NdJ("change",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.SelectUnit())})("ngModelChange",function(o){t.CHM(e);const l=t.oxw();return t.KtG(l.BatchObj.ALTUNITObj=o)}),t.YNc(29,m,2,2,"option",26),t.qZA()(),t.TgZ(30,"td",27),t._uU(31),t.ALo(32,"twoDigitNumber"),t.qZA(),t.TgZ(33,"td",27),t._uU(34),t.ALo(35,"twoDigitNumber"),t.qZA(),t.TgZ(36,"td")(37,"button",28),t.NdJ("click",function(){t.CHM(e);const o=t.oxw();return t.KtG(o.clickButtonClick())}),t.qZA()()(),t.TgZ(38,"tr")(39,"td")(40,"div",29),t._uU(41," Existing Batch : "),t.qZA()()(),t.TgZ(42,"tr"),t._UZ(43,"td",30),t.qZA()()()()}if(2&i){const e=t.oxw();t.xp6(22),t.Q6J("ngModel",e.BatchObj.BCODE),t.xp6(2),t.Q6J("ngModel",e.BatchObj.MFGDATE),t.xp6(2),t.Q6J("ngModel",e.BatchObj.EXPIRY),t.xp6(2),t.Q6J("ngModel",e.BatchObj.ALTUNITObj),t.xp6(1),t.Q6J("ngForOf",e.AlternateUnits),t.xp6(2),t.hij(" ",t.lcZ(32,7,e.BatchObj.PRATE)," "),t.xp6(3),t.hij(" ",t.lcZ(35,9,e.BatchObj.SRATE)," ")}}function B(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"th"),t._uU(2),t.qZA(),t.BQk()),2&i){const e=c.$implicit;t.xp6(2),t.Oqu(e)}}function C(i,c){1&i&&(t.TgZ(0,"th"),t._uU(1,"BATCH"),t.qZA())}function E(i,c){1&i&&(t.TgZ(0,"th",32),t._uU(1,"P-Rate"),t.qZA())}function b(i,c){1&i&&(t.TgZ(0,"th",32),t._uU(1,"S-Rate"),t.qZA())}function w(i,c){1&i&&(t.TgZ(0,"th",32),t._uU(1,"Cost Rate"),t.qZA())}function I(i,c){1&i&&(t.TgZ(0,"th",15),t._uU(1,"EXP DATE"),t.qZA())}function Z(i,c){1&i&&(t.TgZ(0,"th",15),t._uU(1,"MFG DATE"),t.qZA())}function P(i,c){1&i&&(t.TgZ(0,"th",32),t._uU(1,"MRP"),t.qZA())}function O(i,c){if(1&i&&(t.ynx(0),t.TgZ(1,"td",42),t._uU(2),t.qZA(),t.BQk()),2&i){const e=c.$implicit;t.xp6(2),t.hij(" ",e," ")}}function R(i,c){if(1&i&&(t.TgZ(0,"td",43),t._uU(1),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.BATCH)}}function L(i,c){if(1&i&&(t.TgZ(0,"td",44),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.RATE,"1.2-2"))}}function v(i,c){if(1&i&&(t.TgZ(0,"td",44),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.RATE,"1.2-2"))}}function M(i,c){if(1&i&&(t.TgZ(0,"td",45),t._uU(1),t.ALo(2,"date"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.EXPDATE))}}function D(i,c){if(1&i&&(t.TgZ(0,"td",45),t._uU(1),t.ALo(2,"date"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,e.MFGDATE))}}function N(i,c){if(1&i&&(t.TgZ(0,"td",46),t._uU(1),t.ALo(2,"number"),t.qZA()),2&i){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(t.xi3(2,1,e.MRP,"1.2-2"))}}function U(i,c){if(1&i){const e=t.EpF();t.TgZ(0,"tr",33),t.NdJ("click",function(){const l=t.CHM(e).index,f=t.oxw();return t.KtG(f.RowClickEvent(l))})("dblclick",function(){const l=t.CHM(e).$implicit,f=t.oxw();return t.KtG(f.dblClickBatchObj(l))}),t.TgZ(1,"td",34),t._uU(2),t.qZA(),t.YNc(3,O,3,1,"ng-container",12),t.YNc(4,R,2,1,"td",35),t.YNc(5,L,3,4,"td",36),t.YNc(6,v,3,4,"td",36),t.YNc(7,M,3,3,"td",37),t.YNc(8,D,3,3,"td",38),t.TgZ(9,"td",39),t._uU(10),t.qZA(),t.TgZ(11,"td",40),t._uU(12),t.qZA(),t.YNc(13,N,3,4,"td",41),t.qZA()}if(2&i){const e=c.$implicit,n=c.index,o=t.oxw();t.ekj("selected-row",n===o.selectedRowIndex),t.xp6(2),t.Oqu(n+1),t.xp6(1),t.Q6J("ngForOf",e.VariantValues),t.xp6(1),t.Q6J("ngIf",o.needtoShowBatchColumn()),t.xp6(1),t.Q6J("ngIf",14!=o.voucherType&&1!=o.voucherType),t.xp6(1),t.Q6J("ngIf",14==o.voucherType||1==o.voucherType),t.xp6(1),t.Q6J("ngIf",0==o.userSetting.ENABLEDEFAULTEXPIRYDATEENTRY&&1===(null==o.BList[0]?null:o.BList[0].REQEXPDATE)),t.xp6(1),t.Q6J("ngIf",0==o.userSetting.ENABLEDEFAULTEXPIRYDATEENTRY&&1===(null==o.BList[0]?null:o.BList[0].REQEXPDATE)),t.xp6(2),t.hij("",e.STOCK," "),t.xp6(2),t.hij(" ",e.BASEUNIT," "),t.xp6(1),t.Q6J("ngIf","self-billing"!=o.activeurlpath)}}let y=(()=>{class i{constructor(e,n){this.masterRepo=e,this._trnMainService=n,this.dbClickEvent=new t.vpe,this.BatchClosedClick=new t.vpe,this.searchItem=new t.vpe,this.returnBatchValue=new t.vpe,this.multiBatchScheme=new t.vpe,this.isFocus=!0,this.p=[],this.BatchObj={},this.BatchList=[],this.BList=[],this.unitList=[],this.AlternateUnits=[],this.getAttributeValues=(o,l)=>null!=o.VARIANTDETAIL&&o.VARIANTDETAIL[l]&&o.VARIANTDETAIL[l].hasOwnProperty("NAME")?o.VARIANTDETAIL[l].NAME:"",this.userSetting=this.masterRepo.userSetting,console.log("in popnatch",this.userSetting),this.selectedRowIndex=0,this.setClickedRow=function(o){this.selectedRow=o}}ngAfterViewInit(){}ngOnInit(){setTimeout(()=>{null!=document.getElementById("batchFilterPopup")&&document.getElementById("batchFilterPopup").focus()},500)}SelectUnit(){this.BatchObj.UNIT=this.BatchObj.ALTUNITObj.ALTUNIT,this.BatchObj.PRATE=this.BatchObj.ALTUNITObj.PRATE,this.BatchObj.SRATE=this.BatchObj.ALTUNITObj.RATE}pagingChange(e){this.p[this.tabindex]=e}setFocus(){}SearchList(e){}PopupItemListRowClick(e){this.selectedRowIndex=e}itemBatchClosed(){this.BatchClosedClick.emit()}keydownClick(){}AddNewBatch(){}tabClick(){this.returnBatchValue.emit(this.BatchObj)}clickPlusButton(){this.tabClick()}needtoShowBatchColumn(){return 2==this.userSetting.EnableBatch||1===this.BatchList[0]?.REQEXPDATE||"self-billing"==this.activeurlpath||!(14==this.voucherType||16==this.voucherType||1==this.voucherType)}clickButtonClick(){null!=this.BatchObj.BATCH?this.BatchObj.MFGDATE>this.BatchObj.EXPIRY?alert("Manufacture date cannot be greater than Expiry date!!"):this.BatchObj.SRATE>this.BatchObj.MRP||null!=this.BatchObj.MFGDATE&&null!=this.BatchObj.EXPIRY?this.tabClick():alert("MFGDate and ExpDate cannot be empty!"):alert("Please enter Batch no.")}RowClickEvent(e){this.selectedRowIndex=e}dblClickBatchObj(e){this.dbClickEvent.emit(e)}MultiBatchEntryClicked(){var e=this.BList.filter(o=>o.tQuantity>0),n=e[0];null!=n?null==e.filter(o=>o.SCHEME.schemeID!=n.SCHEME.schemeID)[0]?null==e.filter(o=>o.STOCK<o.tQuantity)[0]?this.multiBatchScheme.emit(e):alert("Exceed Quantity than Stock detected..."):alert("Can not Choose multi batch of different Scheme..."):alert("Row with valid Quantity not detected...")}updown(e){null==this.selectedRowIndex&&(this.selectedRowIndex=0),"ArrowDown"===e.code?(this.selectedRowIndex=this.selectedRowIndex+1,this.selectedRowIndex>this.BList.length-1&&(this.selectedRowIndex=this.BList.length-1)):"ArrowUp"===e.code&&(this.selectedRowIndex=this.selectedRowIndex-1,this.selectedRowIndex<0&&(this.selectedRowIndex=0)),"Enter"===e.code||"NumpadEnter"==e.code?null!=this.selectedRowIndex&&null!=this.BList[this.selectedRowIndex]&&this.dblClickBatchObj(this.BList[this.selectedRowIndex]):"Escape"===e.code&&this.itemBatchClosed()}ngOnChanges(e){e&&e.BList&&(this.BList=e.BList.currentValue,this.headerKeys=[],this.BList.forEach(n=>{n.VARIANTDETAIL=n.hasOwnProperty("VARIANTDETAIL")&&null!=n.VARIANTDETAIL?n.VARIANTDETAIL:null}),this.BList.forEach(n=>{for(var o in n.VariantValues=[],n.VARIANTDETAIL){let l=o.toUpperCase();-1==this.headerKeys.indexOf(l)&&this.headerKeys.push(l),n.VariantValues.push(n.VARIANTDETAIL[o])}}))}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(u.P),t.Y36(a.p))},i.\u0275cmp=t.Xpm({type:i,selectors:[["PBatchList"]],viewQuery:function(e,n){if(1&e&&(t.Gf(s,5),t.Gf(g,5)),2&e){let o;t.iGM(o=t.CRH())&&(n._BE=o.first),t.iGM(o=t.CRH())&&(n._Search=o.first)}},hostBindings:function(e,n){1&e&&t.NdJ("keydown",function(l){return n.updown(l)},!1,t.evT)},inputs:{title:"title",tabindex:"tabindex",inputSearch:"inputSearch",BList:"BList",voucherType:"voucherType",activerowIndex:"activerowIndex",AlternateUnits:"AlternateUnits",activeurlpath:"activeurlpath"},outputs:{dbClickEvent:"dbClickEvent",BatchClosedClick:"BatchClosedClick",searchItem:"searchItem",returnBatchValue:"returnBatchValue",multiBatchScheme:"multiBatchScheme"},features:[t.TTD],decls:31,vars:16,consts:[[1,"modal-sticky",2,"width","50vw"],[1,"modal-content",2,"padding","2px !important","box-shadow","-10px 0px 10px 1px #aaaaaa","width","101%","margin-left","1pc","margin-top","5pc","min-height","350px","max-height","350px","overflow","scroll","overflow-x","hidden"],[1,"modal-header",2,"padding","0px","background","#7ed0ff"],[1,"modal-title"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[4,"ngIf"],[1,"col-md-12",2,"padding","0px"],["type","text","id","batchFilterPopup","placeholder","Search by Batch...",2,"width","100%","/* padding","1px","*/padding-left","5px",3,"ngModel","ngModelChange"],["inputBox",""],[1,"Table1",2,"padding","0px","margin-top","2px","width","100%","overflow","scroll"],[2,"background","#7ed0ff"],[4,"ngFor","ngForOf"],["style","text-align: right;",4,"ngIf"],["style","text-align: center",4,"ngIf"],[2,"text-align","center"],["aria-disabled","true","class","highlight",3,"selected-row","click","dblclick",4,"ngFor","ngForOf"],[1,"col-md-12",2,"padding","1px"],[1,"col-md-12"],[1,"Table1",2,"padding","0px","margin-top","2px","width","100%"],[2,"border","1px solid #e6e6e6"],[1,"CellWithComment"],["BatchEntry",""],["type","text",2,"height","23px","border","1px solid #e6e6e6","width","100px",3,"ngModel","ngModelChange"],["type","date",2,"height","33px","border","1px solid #e6e6e6","width","130px",3,"ngModel","ngModelChange"],[2,"height","33px","border","1px solid #e6e6e6","width","80px",3,"ngModel","change","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"CellWithComment",2,"height","33px","border","1px solid #e6e6e6","width","100px"],[1,"glyphicon","glyphicon-chevron-right",3,"click"],[1,"col-md-12",2,"padding","1px","margin-top","15px"],["colspan","6"],[3,"ngValue"],[2,"text-align","right"],["aria-disabled","true",1,"highlight",3,"click","dblclick"],[2,"border-bottom","1px solid #ddd","height","23px","width","5%"],["style","border-bottom: 1px solid #ddd;height: 23px;width:21%",4,"ngIf"],["style","border-bottom: 1px solid #ddd;height: 23px;width:12%;text-align: right;",4,"ngIf"],["style","border-bottom: 1px solid #ddd;height: 23px;width:18%;text-align: center;",4,"ngIf"],["style","border-bottom: 1px solid #ddd;height: 23px;width:18%;text-align: center",4,"ngIf"],[2,"border-bottom","1px solid #ddd","height","23px","width","10%","text-align","center"],[2,"border-bottom","1px solid #ddd","height","23px","width","9%"],["style","border-bottom: 1px solid #ddd;height: 23px;width:13%;text-align: right;",4,"ngIf"],[2,"border-bottom","1px solid #ddd","height","23px","width","10%"],[2,"border-bottom","1px solid #ddd","height","23px","width","21%"],[2,"border-bottom","1px solid #ddd","height","23px","width","12%","text-align","right"],[2,"border-bottom","1px solid #ddd","height","23px","width","18%","text-align","center"],[2,"border-bottom","1px solid #ddd","height","23px","width","13%","text-align","right"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5",3),t._uU(4),t.qZA(),t.TgZ(5,"button",4),t.NdJ("click",function(){return n.itemBatchClosed()}),t.TgZ(6,"span",5),t._uU(7,"\xd7"),t.qZA()()(),t.YNc(8,A,44,11,"div",6),t.TgZ(9,"div",7)(10,"input",8,9),t.NdJ("ngModelChange",function(l){return n.filter=l}),t.qZA()(),t.TgZ(12,"table",10)(13,"tr",11)(14,"th"),t._uU(15,"Sn."),t.qZA(),t.YNc(16,B,3,1,"ng-container",12),t.YNc(17,C,2,0,"th",6),t.YNc(18,E,2,0,"th",13),t.YNc(19,b,2,0,"th",13),t.YNc(20,w,2,0,"th",13),t.YNc(21,I,2,0,"th",14),t.YNc(22,Z,2,0,"th",14),t.TgZ(23,"th",15),t._uU(24,"Stock"),t.qZA(),t.TgZ(25,"th"),t._uU(26,"Unit"),t.qZA(),t.YNc(27,P,2,0,"th",13),t.qZA(),t.TgZ(28,"tbody"),t.YNc(29,U,14,12,"tr",16),t.ALo(30,"searchData"),t.qZA()()()()),2&e&&(t.xp6(4),t.Oqu(n.title),t.xp6(4),t.Q6J("ngIf",3==n.voucherType||24==n.voucherType),t.xp6(2),t.Q6J("ngModel",n.filter),t.xp6(6),t.Q6J("ngForOf",n.headerKeys),t.xp6(1),t.Q6J("ngIf",n.needtoShowBatchColumn()),t.xp6(1),t.Q6J("ngIf",14!=n.voucherType&&1!=n.voucherType),t.xp6(1),t.Q6J("ngIf",14==n.voucherType&&"self-billing"!=n.activeurlpath||1==n.voucherType),t.xp6(1),t.Q6J("ngIf",14==n.voucherType&&"self-billing"==n.activeurlpath),t.xp6(1),t.Q6J("ngIf",0==n.userSetting.ENABLEDEFAULTEXPIRYDATEENTRY&&1===(null==n.BList[0]?null:n.BList[0].REQEXPDATE)),t.xp6(1),t.Q6J("ngIf",0==n.userSetting.ENABLEDEFAULTEXPIRYDATEENTRY&&1===(null==n.BList[0]?null:n.BList[0].REQEXPDATE)),t.xp6(5),t.Q6J("ngIf","self-billing"!=n.activeurlpath),t.xp6(2),t.Q6J("ngForOf",t.Dn7(30,12,n.BList,n.filter,"BATCH")))},dependencies:[d.sg,d.O5,r.YN,r.Kr,r.Fj,r.EJ,r.JJ,r.On,d.JJ,d.uU,_.g,T.C],styles:[".selected-row[_ngcontent-%COMP%] {\n    background-color: #ced6d3 !important;\n  }\n  .modal-sticky[_ngcontent-%COMP%]{\n    right: 55px;\n  }\n\n  .unitLabel[_ngcontent-%COMP%]{\n    width: auto;\n    font-size: 14px;\n    margin-left: 5px;\n  }"]}),i})()}}]);