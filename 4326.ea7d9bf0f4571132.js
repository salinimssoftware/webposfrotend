"use strict";(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[4326],{71459:(M,C,c)=>{c.d(C,{J:()=>_});var l=c(20092),g=c(64537);let _=(()=>{class p{}return p.\u0275fac=function(u){return new(u||p)},p.\u0275mod=g.oAB({type:p}),p.\u0275inj=g.cJS({imports:[l.UX,l.u5]}),p})()},55618:(M,C,c)=>{c.d(C,{c:()=>E});var l=c(88692),g=c(71800),_=c(72533),p=c(18488),m=c(53074),u=c(20092),b=c(47766),d=c(64537);let T=(()=>{class t{static forRoot(){return{ngModule:t}}}return t.\u0275fac=function(I){return new(I||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[l.ez,u.u5,u.UX,_.JX]}),t})(),E=(()=>{class t{static forRoot(){return{ngModule:t,providers:[m.P,p.G]}}}return t.\u0275fac=function(I){return new(I||t)},t.\u0275mod=d.oAB({type:t}),t.\u0275inj=d.cJS({imports:[l.ez,g.zk.forRoot(),_.JX,l.ez,u.u5,u.UX,b.e,T.forRoot()]}),t})()},82738:(M,C,c)=>{c.d(C,{b:()=>b});var l=c(88692),g=c(72533),_=c(87584),p=c(71800),m=c(53074),u=c(64537);let b=(()=>{class d{static forRoot(){return{ngModule:d,providers:[m.P,_.p]}}}return d.\u0275fac=function(E){return new(E||d)},d.\u0275mod=u.oAB({type:d}),d.\u0275inj=u.cJS({imports:[l.ez,p.zk.forRoot(),g.JX]}),d})()},77879:(M,C,c)=>{c.d(C,{H:()=>_});var l=c(64537),g=c(53074);let _=(()=>{class p{constructor(u){this.masterRepo=u}ngOnInit(){}isOldFYearDB(){return 1===this.masterRepo.userSetting.IsOldFyearDB}}return p.\u0275fac=function(u){return new(u||p)(l.Y36(g.P))},p.\u0275dir=l.lG2({type:p,selectors:[["","appOldFYearDB",""]],exportAs:["appOldFYearDB"]}),p})()},4326:(M,C,c)=>{c.r(C),c.d(C,{ContractPriceModule:()=>ut});var l=c(88692),g=c(54536),_=c(82738),p=c(46543),m=c(72533),u=c(12640),b=c(59629),d=c(7976),T=c(19102),E=c(40216),t=c(64537),f=c(67311),I=c(14970),S=c(53074),D=c(87584),h=c(20092),A=c(28698),P=c(77879),v=c(23470);let w=(()=>{class r{transform(e,n){if(e)return n?e.filter(i=>{const o=n.replace(/[^A-Z0-9]/gi,"").toLowerCase();if(-1!==(i.ITEMNAME?i.ITEMNAME.replace(/[^A-Z0-9]/gi,"").toLowerCase():"").indexOf(o))return i}):e}}return r.\u0275fac=function(e){return new(e||r)},r.\u0275pipe=t.Yjl({name:"searchDatas",type:r,pure:!1}),r})();const R=["genericGridCustomer"],N=["genericGridProduct"],y=["genericGridViewEdit"],j=["genericGridSupplier"],U=["fileUploadPopup"];function Z(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.Reset())}),t._uU(1,"Reset F3"),t.qZA()}}function L(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",34,35),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onSave())}),t._uU(2,"Save F6"),t.qZA()}if(2&r){const e=t.MAs(1),n=t.oxw();t.Q6J("disabled",n.disableOnSave||e.isOldFYearDB())}}function W(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",34,35),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onEditclicked())}),t._uU(2,"Edit F7"),t.qZA()}if(2&r){const e=t.MAs(1);t.Q6J("disabled",e.isOldFYearDB())}}function k(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",8),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onViewclicked())}),t._uU(1,"View F4"),t.qZA()}}function G(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",36,35),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onDeleteClick())}),t._uU(2,"Delete"),t.qZA()}if(2&r){const e=t.MAs(1);t.Q6J("disabled",e.isOldFYearDB())}}function F(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"button",37),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.showFileUploadPopUp())}),t._uU(1,"Import Contract Price F2"),t.qZA()}}function J(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"div",38)(1,"div",1)(2,"div",39)(3,"div")(4,"label",40),t._uU(5,"Price Name:"),t.qZA(),t.TgZ(6,"input",41),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.PRICENAME=i)}),t.qZA()(),t.TgZ(7,"div",42)(8,"label",40),t._uU(9,"Pricing Type:"),t.qZA(),t.TgZ(10,"select",43),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.CONTRACTPRICETYPE=i)}),t.TgZ(11,"option",44),t._uU(12,"Customer Contract Pricing"),t.qZA(),t.TgZ(13,"option",45),t._uU(14,"Supplier Contract Pricing"),t.qZA()()()()(),t.TgZ(15,"div",46)(16,"div",47)(17,"div",48)(18,"label",49),t._uU(19,"Start Date:"),t.qZA(),t.TgZ(20,"input",50),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.STARTDATE=i)})("change",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.changeEntryDate(i.target.value,"AD"))}),t.qZA(),t.TgZ(21,"div",51)(22,"nepali-date-picker",52),t.NdJ("change",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.changeEntryDate(i.detail.value,"BS"))})("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.STARTBSDATE=i)}),t.qZA()()(),t.TgZ(23,"div",53)(24,"label",49),t._uU(25,"Expiry Date:"),t.qZA(),t.TgZ(26,"input",50),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.ENDDATE=i)})("change",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.changeEndDate(i.target.value,"AD"))}),t.qZA(),t.TgZ(27,"div",51)(28,"nepali-date-picker",54),t.NdJ("change",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.changeEndDate(i.detail.value,"BS"))})("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.ENDBSDATE=i)}),t.qZA()()()()(),t.TgZ(29,"div",1)(30,"input",55),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.PRICEMODE=i)})("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onSelectMode())}),t.qZA(),t._uU(31," Load Item \xa0 "),t.TgZ(32,"input",55),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.contractpriceObj.PRICEMODE=i)})("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onSelectMode())}),t.qZA(),t._uU(33," Load Group \xa0 "),t.qZA()()}if(2&r){const e=t.oxw();t.xp6(6),t.Q6J("ngModel",e.contractpriceObj.PRICENAME)("disabled","VIEW"==e.Mode),t.xp6(4),t.Q6J("ngModel",e.contractpriceObj.CONTRACTPRICETYPE)("disabled","VIEW"==e.Mode||e.contractpriceObj.CustName),t.xp6(10),t.Q6J("ngModel",e.contractpriceObj.STARTDATE)("disabled","VIEW"==e.Mode),t.xp6(2),t.Q6J("id","nepaliDatefrom")("label","From")("ngModel",e.contractpriceObj.STARTBSDATE)("disable",e._trnMainService.disableNepaliDate),t.xp6(4),t.Q6J("ngModel",e.contractpriceObj.ENDDATE)("disabled","VIEW"==e.Mode),t.xp6(2),t.Q6J("id","nepaliDateto")("disable",e._trnMainService.disableNepaliDate)("label","From")("ngModel",e.contractpriceObj.ENDBSDATE),t.xp6(2),t.Q6J("ngModel",e.contractpriceObj.PRICEMODE)("value",1)("disabled","VIEW"==e.Mode||"EDIT"==e.Mode&&2==e.contractpriceObj.PRICEMODE),t.xp6(2),t.Q6J("ngModel",e.contractpriceObj.PRICEMODE)("value",2)("disabled","VIEW"==e.Mode||"EDIT"==e.Mode&&1==e.contractpriceObj.PRICEMODE)}}function B(r,a){1&r&&(t.TgZ(0,"th",56),t._uU(1,"ITEM NAME"),t.qZA())}function V(r,a){1&r&&(t.TgZ(0,"th",56),t._uU(1,"GROUP NAME"),t.qZA())}function Y(r,a){1&r&&(t.TgZ(0,"th",57),t._uU(1,"UNIT"),t.qZA())}function H(r,a){1&r&&(t.TgZ(0,"th",58),t._uU(1,"RATE"),t._UZ(2,"br"),t._uU(3,"(EX-VAT)"),t.qZA())}function K(r,a){1&r&&(t.TgZ(0,"th",58),t._uU(1,"MRP"),t.qZA())}function Q(r,a){1&r&&(t.TgZ(0,"th",25),t._uU(1,"CONTRACT S-PRICE"),t._UZ(2,"br"),t._uU(3,"(EX-VAT)"),t.qZA())}function q(r,a){1&r&&(t.TgZ(0,"option",71),t._uU(1,"Flat rate"),t.qZA())}function z(r,a){if(1&r&&(t.TgZ(0,"td",61),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.UNIT,"")}}function X(r,a){if(1&r&&(t.TgZ(0,"td",68),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.RATE)}}function $(r,a){if(1&r&&(t.TgZ(0,"td",68),t._uU(1),t.qZA()),2&r){const e=t.oxw().$implicit;t.xp6(1),t.Oqu(e.MRP)}}function tt(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"td",68)(1,"input",72),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw().$implicit;return t.KtG(o.CONTRACT_SPRICE=i)})("keydown.enter",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.addRow())})("keydown.tab",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.addRow())}),t.qZA()()}if(2&r){const e=t.oxw(),n=e.index,i=e.$implicit,o=t.oxw();t.xp6(1),t.MGl("id","contractSprice",n,""),t.Q6J("disabled","VIEW"==o.Mode||"DISCOUNT"==i.DiscountType)("ngModel",i.CONTRACT_SPRICE)}}function et(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"tr",59),t.NdJ("click",function(){const o=t.CHM(e).index,s=t.oxw();return t.KtG(s.rowClick(o))}),t.TgZ(1,"td",60),t._uU(2),t.qZA(),t.TgZ(3,"td",61)(4,"input",62),t.NdJ("keydown.enter",function(){const o=t.CHM(e).index,s=t.oxw();return t.KtG(s.ProductList(o))})("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.KtG(s.ITEMNAME=i)})("keydown.Shift.Delete",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.clearRow(i))}),t.qZA()(),t.TgZ(5,"td",61)(6,"select",63),t.NdJ("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.KtG(s.DiscountType=i)})("change",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.onChangeMode())}),t.YNc(7,q,2,0,"option",64),t.TgZ(8,"option",65),t._uU(9,"Discount"),t.qZA()()(),t.YNc(10,z,2,1,"td",66),t.YNc(11,X,2,1,"td",67),t.YNc(12,$,2,1,"td",67),t.TgZ(13,"td",68)(14,"input",69),t.NdJ("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.KtG(s.DISCOUNT=i)})("keydown.enter",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addRow())})("keydown.tab",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.addRow())}),t.qZA()(),t.YNc(15,tt,2,3,"td",67),t.TgZ(16,"td",61)(17,"input",70),t.NdJ("change",function(i){const s=t.CHM(e).$implicit;return t.KtG(s.ISACTIVE=i.target.checked?1:0)})("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.KtG(s.ISACTIVE=i)}),t.qZA()()()}if(2&r){const e=a.$implicit,n=a.index,i=t.oxw();t.xp6(2),t.hij(" ",n+1," "),t.xp6(2),t.MGl("id","itemname",n,""),t.Q6J("ngModel",e.ITEMNAME)("disabled","VIEW"==i.Mode),t.xp6(2),t.MGl("id","discountType",n,""),t.Q6J("ngModel",e.DiscountType)("disabled","VIEW"==i.Mode),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(3),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(2),t.MGl("id","discount",n,""),t.Q6J("ngModel",e.DISCOUNT)("disabled","VIEW"==i.Mode||"FLAT"==e.DiscountType&&"1"==i.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf","1"==i.contractpriceObj.PRICEMODE),t.xp6(2),t.MGl("id","contractSprice",n,""),t.Q6J("ngModel",e.ISACTIVE)("disabled","VIEW"==i.Mode)}}const nt=["genericGridCustomer"],ot=["genericGridProduct"];function rt(r,a){1&r&&(t.TgZ(0,"button",8),t._uU(1,"Export"),t.qZA())}function ct(r,a){1&r&&(t.TgZ(0,"button",8),t._uU(1,"Excel"),t.qZA())}function st(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"div",25)(1,"div",26)(2,"div",27)(3,"div")(4,"label",28),t._uU(5,"Item Name:"),t.qZA(),t.TgZ(6,"input",29),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.itemWiseObj.ITEMNAME=i)})("keydown.enter",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.itemEnterCommand())}),t.qZA()()()(),t.TgZ(7,"div",26)(8,"div",30)(9,"div")(10,"label",31),t._uU(11,"Contract Pricing Type:"),t.qZA(),t.TgZ(12,"select",32),t.NdJ("ngModelChange",function(i){t.CHM(e);const o=t.oxw();return t.KtG(o.itemWiseObj.CONTRACTPRICETYPE=i)}),t.TgZ(13,"option",33),t._uU(14,"Customer Contract Pricing"),t.qZA(),t.TgZ(15,"option",34),t._uU(16,"Supplier Contract Pricing"),t.qZA()()()()(),t.TgZ(17,"div",26)(18,"fieldset",35)(19,"legend",36),t._uU(20,"MRP :"),t.qZA(),t.TgZ(21,"div",37),t._uU(22),t.qZA()()()()}if(2&r){const e=t.oxw();t.xp6(6),t.Q6J("ngModel",e.itemWiseObj.ITEMNAME),t.xp6(6),t.Q6J("ngModel",e.itemWiseObj.CONTRACTPRICETYPE),t.xp6(10),t.Oqu(e.itemWiseObj.MRP)}}function at(r,a){if(1&r){const e=t.EpF();t.TgZ(0,"tr",38),t.NdJ("click",function(){const o=t.CHM(e).index,s=t.oxw();return t.KtG(s.rowClick(o))}),t.TgZ(1,"td",39),t._uU(2),t.qZA(),t.TgZ(3,"td",40),t._uU(4),t.qZA(),t.TgZ(5,"td",40),t._uU(6),t.qZA(),t.TgZ(7,"td",41),t._uU(8),t.qZA(),t.TgZ(9,"td",41),t._uU(10),t.qZA(),t.TgZ(11,"td",42),t._uU(12),t.qZA(),t.TgZ(13,"td",41),t._uU(14),t.qZA(),t.TgZ(15,"td",41),t._uU(16),t.qZA(),t.TgZ(17,"td",41)(18,"input",43),t.NdJ("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.KtG(s.NEW_SRATE=i)})("ngModelChange",function(){const o=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.onNewSRateEntry(o.NEW_SRATE))}),t.qZA()(),t.TgZ(19,"td",41)(20,"input",43),t.NdJ("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.KtG(s.NEW_DRATE=i)})("ngModelChange",function(){const o=t.CHM(e).$implicit,s=t.oxw();return t.KtG(s.onNewDisRateEntry(o.NEW_DRATE))}),t.qZA()(),t.TgZ(21,"td",42)(22,"input",44),t.NdJ("change",function(i){const s=t.CHM(e).$implicit;return t.KtG(s.ISACTIVE=i.target.checked?1:0)})("ngModelChange",function(i){const s=t.CHM(e).$implicit;return t.KtG(s.ISACTIVE=i)}),t.qZA()()()}if(2&r){const e=a.$implicit,n=a.index,i=t.oxw();t.xp6(2),t.hij(" ",n+1," "),t.xp6(2),t.hij("",e.CUSTNAME," "),t.xp6(2),t.hij("",e.ADDRESS," "),t.xp6(2),t.hij("",e.VATNO," "),t.xp6(2),t.hij("",e.MRP," "),t.xp6(2),t.hij("",e.DISCOUNTTYPE," "),t.xp6(2),t.hij("",e.CURRENT_SRATE," "),t.xp6(2),t.hij("",e.CURRENT_DRATE," "),t.xp6(2),t.MGl("id","NewSrate",n,""),t.Q6J("ngModel",e.NEW_SRATE),t.xp6(2),t.MGl("id","NewDisrate",n,""),t.Q6J("ngModel",e.NEW_DRATE),t.xp6(2),t.MGl("id","isactive",n,""),t.Q6J("ngModel",e.ISACTIVE)("disabled","VIEW"==i.Mode)}}const lt=[{path:"",component:(()=>{class r{constructor(e,n,i,o,s,O){this.alertService=e,this.loadingService=n,this.masterService=i,this._trnMainService=o,this._alertService=s,this.router=O,this.ShowMore=!1,this.showStockedQuantityOnly=0,this.activerowIndex=0,this.contractpriceObj={},this.hidecontractPrice=!0,this.userProfile={},this.gridPopupSettingsForCustomer=new T.sG,this.gridPopupSettingsForproduct=new T.sG,this.gridPopupSettingsForView=new T.sG,this.gridPopupSettingsForSupplier=new T.sG,this.fileUploadPopupSettings=new E.s;var x=this.masterService.PhiscalObj.BeginDate;x=x.substring(0,10),this.date2=x,console.log(this.date2),this.showSecondaryButtons=!1}ngOnInit(){const e=new Date;this.currDate=(0,l.p6)(e,"yyyy-MM-dd","en-US"),this.Reset(),this.contractpriceObj.CList[this.activerowIndex].ISACTIVE=1,this.contractpriceObj.CONTRACTPRICETYPE="CUSTOMER",this.Mode="ADD",this.fileUploadPopupSettings=Object.assign(new E.s,{title:"Import Contract Price",sampleFileUrl:"/downloadSampleExcelforMasterMigration?importName=Contract Price",uploadEndpoints:"/importExcelForContractPrice",allowMultiple:!1,acceptFormat:".xlsx",filename:"Import Contract Price Sample"})}showMore(){this.ShowMore=!this.ShowMore}itemWiseEntry(){try{this.router.navigate(["./pages/masters/Contract-price/item-wise-entry",{mode:"add",returnUrl:this.router.url}])}catch{}}CusWiseEntry(){try{this.router.navigate(["/pages/masters/Contract-price"])}catch{}}hide(){}rowClick(e){this.activerowIndex=e}getBsDate(e){let n=c(10484),i=e.replace("-","/").replace("-","/"),o=n.ad2bs(i);return("1"==o.en.day||"2"==o.en.day||"3"==o.en.day||"4"==o.en.day||"5"==o.en.day||"6"==o.en.day||"7"==o.en.day||"8"==o.en.day||"9"==o.en.day?"0"+o.en.day:o.en.day)+"/"+("1"==o.en.month||"2"==o.en.month||"3"==o.en.month||"4"==o.en.month||"5"==o.en.month||"6"==o.en.month||"7"==o.en.month||"8"==o.en.month||"9"==o.en.month?"0"+o.en.month:o.en.month)+"/"+o.en.year}InitialFormLoad(){this.masterService.getCurrentDate().subscribe(e=>{this.contractpriceObj.STARTDATE=e.Date.substring(0,10),this.contractpriceObj.ENDDATE=e.Date.substring(0,10),this.contractpriceObj.STARTBSDATE=this.getBsDate(this.contractpriceObj.STARTDATE),this.contractpriceObj.ENDBSDATE=this.getBsDate(this.contractpriceObj.ENDDATE)},e=>{this.masterService.resolveError(e,"voucher-date - getCurrentDate")})}addRow(){if(""==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].MRP||null==this.contractpriceObj.CList[this.activerowIndex].MRP)return void this.alertService.warning("Please Select the Item Name.");if("FLAT"==this.contractpriceObj.CList[this.activerowIndex].DiscountType)if(this.contractpriceObj.CList[this.activerowIndex].PRATE>this.contractpriceObj.CList[this.activerowIndex].CONTRACT_SPRICE||null==this.contractpriceObj.CList[this.activerowIndex].CONTRACT_SPRICE){let i=this.checkForUserRigths("AllowContractPriceBelowPRate");if(i&&0==i?.value)return void this.alertService.info("Contract Price cannot be less than "+this.contractpriceObj.CList[this.activerowIndex].PRATE)}else{if(this.contractpriceObj.CList[this.activerowIndex].CONTRACT_SPRICE<0)return void this.alertService.info("Contract Price Cannot be negative");if(this.contractpriceObj.CList[this.activerowIndex].CONTRACT_SPRICE<0)return void this.alertService.info("Contract Price Cannot be negative")}if("DISCOUNT"==this.contractpriceObj.CList[this.activerowIndex].DiscountType){if(this.contractpriceObj.CList[this.activerowIndex].DISCOUNT>=100)return void this.alertService.info("The discount cannot be more than 100");if(this.contractpriceObj.CList[this.activerowIndex].DISCOUNT<0)return void this.alertService.info("The discount cannot be in negative")}null==this.contractpriceObj.CList&&(this.contractpriceObj.CList=[]);try{var e={};e.DiscountType=2==this.contractpriceObj.PRICEMODE?"DISCOUNT":"FLAT",this.contractpriceObj.CList.push(e)}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n).focus()},50),this.contractpriceObj.CList.forEach(i=>{i.ISACTIVE=1})}checkForUserRigths(e){if(e)return this.masterService.userProfile.userRights.find(n=>n.right==e)}nextRow(){null==this.contractpriceObj.CList&&(this.contractpriceObj.CList=[]);try{var e={};e.DiscountType=2==this.contractpriceObj.PRICEMODE?"DISCOUNT":"FLAT",this.contractpriceObj.CList.push(e)}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n).focus()},50),this.contractpriceObj.CList.forEach(i=>{i.ISACTIVE=1})}changeEntryDate(e,n){"AD"==n?this.contractpriceObj.STARTBSDATE=this.masterService.toBSDate(e):"BS"==n&&(this.contractpriceObj.STARTDATE=this.masterService.toADDate(e))}changeEndDate(e,n){"AD"==n?this.contractpriceObj.ENDBSDATE=this.masterService.toBSDate(e):"BS"==n&&(this.contractpriceObj.ENDDATE=this.masterService.toADDate(e))}ProductList(e){this.activerowIndex=e,this.getProductList(),this.genericGridProduct.show()}getProductList(){this.gridPopupSettingsForproduct={title:1==this.contractpriceObj.PRICEMODE?"PRODUCTS":"GROUPS",apiEndpoints:1==this.contractpriceObj.PRICEMODE?`/getMenuitemWithStockPagedList/${this.showStockedQuantityOnly}/A/all/NO/${this._trnMainService.userProfile.userWarehouse}`:"/getItemGroupListExceptService",defaultFilterIndex:1,useDefinefilterValue:"",columns:[{key:"MENUCODE",title:1==this.contractpriceObj.PRICEMODE?"PRODUCT CODE":"GROUP CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"DESCRIPTION",hidden:!1,noSearch:!1},{key:"BASEUNIT",title:"UNIT",hidden:1!=this.contractpriceObj.PRICEMODE,noSearch:!0},{key:"MRP",title:"MRP",hidden:!1,noSearch:!0,alignment:"right",pipe:!0}]},this.genericGridProduct.show()}onProductSelected(e){if(this.finds=this.contractpriceObj.CList.find(i=>i.MCODE==e.MCODE),void 0!==this.finds)return void this.alertService.info("The Items cannot be selected twice");this.contractpriceObj.CList[this.activerowIndex].MCODE=e.MCODE,this.contractpriceObj.CList[this.activerowIndex].ITEMCODE=e.MENUCODE,this.contractpriceObj.CList[this.activerowIndex].MCODE=e.MCODE,this.contractpriceObj.CList[this.activerowIndex].ITEMNAME=e.DESCA,this.contractpriceObj.CList[this.activerowIndex].UNIT=e.BASEUNIT,this.contractpriceObj.CList[this.activerowIndex].MRP=e.MRP,this.contractpriceObj.CList[this.activerowIndex].ISVAT=e.ISVAT,this.contractpriceObj.CList[this.activerowIndex].PRATE=e.PRATE,this.contractpriceObj.CList[this.activerowIndex].RATE=e.RATE,this.contractpriceObj.CList[this.activerowIndex].CUSTID=this.contractpriceObj.CustID,2==this.contractpriceObj.PRICEMODE&&(this.contractpriceObj.CList[this.activerowIndex].DiscountType="DISCOUNT",this.contractpriceObj.CList[this.activerowIndex].CONTRACT_SPRICE=0);let n=this.activerowIndex;setTimeout(()=>{document.getElementById("discountType"+n).focus()},100)}CalculateDiscount(){let e=this.contractpriceObj.CList[this.activerowIndex];1==e.ISVAT&&(console.log("VATMRP",e.MRP),e.CONTRACT_SPRICE=Number((e.MRP/1.13-e.MRP/1.13*e.DISCOUNT/100).toFixed(5))),e.DISCOUNT<=0&&(e.CONTRACT_SPRICE=0),0==e.ISVAT&&(console.log("NOVATMRP",e.MRP),e.CONTRACT_SPRICE=Number((e.MRP-e.MRP*e.DISCOUNT/100).toFixed(5))),console.log("item.CONTRACT_PSRCIE",e.CONTRACT_SPRICE)}onSave(){console.log(" TABLE SAVE VALUE",this.contractpriceObj);try{if(""==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME)return void this.alertService.warning("Please Select the Item Name.");this.removeInvalidRows(),this.submitSave()}catch(e){alert(e)}}submitSave(){this.loadingService.show("Saving Contract Price, Please Wait..."),this.masterService.saveContractPrice(this.Mode,this.contractpriceObj).subscribe(e=>{console.log("contract price save result",e),"ok"==e.status?(this.loadingService.hide(),this.alertService.success(e.result),this.Reset()):(this.loadingService.hide(),this.alertService.info(e.result.error))})}removeInvalidRows(){this.contractpriceObj.CList=this.contractpriceObj.CList.filter(e=>null!=e.MCODE&&""!=e.MCODE),this.contractpriceObj.CList=this.contractpriceObj.CList.filter(e=>null!=e.ITEMCODE&&""!=e.ITEMCODE)}onEditclicked(){this.Mode="EDIT",this.getContractPriceList(),this.genericGridViewEdit.show(),this._trnMainService.disableNepaliDate=!1}onViewclicked(){this.Mode="VIEW",this.getContractPriceList(),this.genericGridViewEdit.show(),this._trnMainService.disableNepaliDate=!0}getContractPriceList(){this.gridPopupSettingsForView={title:"Contract Pricing List",apiEndpoints:"/getContractPricePagedList/ptype=all",defaultFilterIndex:0,useDefinefilterValue:null,columns:[{key:"CMID",title:"Price ID",hidden:!1,noSearch:!1},{key:"PRICENAME",title:"Price Name",hidden:!1,noSearch:!1}]}}onContactPriceSelected(e){console.log("contract price selecet",e),this.contractpriceObj.PRICENAME=e.PRICENAME,this.contractpriceObj.STARTDATE=e.STARTDATE?e.STARTDATE.toString().substring(0,10):"",this.contractpriceObj.ENDDATE=e.ENDDATE?e.ENDDATE.toString().substring(0,10):"",this.contractpriceObj.CMID=e.CMID,this.contractpriceObj.CONTRACTPRICETYPE=e.CONTRACTPRICETYPE,this.contractpriceObj.PRICEMODE=e.PRICEMODE?e.PRICEMODE:1,this.changeEntryDate(this.contractpriceObj.STARTDATE,"AD"),this.changeEndDate(this.contractpriceObj.ENDDATE,"AD"),console.log("contracct price after loading",this.contractpriceObj),this.loadingService.show("Loading Contract Price Details. Please Wait"),this.masterService.loadContractPriceDetails(this.contractpriceObj.CMID).subscribe(n=>{if(console.log("result from contract price laoding",n),"ok"==n.status){this.contractpriceObj.CList=[];let i=n.result;i.length>0&&i.forEach(o=>{let s={};s.CMID=o.CMID,s.CUSTID=o.CUSTID,s.ITEMCODE=o.ITEMCODE,s.MCODE=o.ITEMCODE,s.ITEMNAME=o.ITEMNAME,s.UNIT=o.UNIT,s.MRP=o.MRP,s.ISACTIVE=o.ISACTIVE,s.ISVAT=o.VAT,s.DiscountType=o.DISCOUNTTYPE,s.DISCOUNT=o.DISCOUNT,s.CONTRACT_SPRICE=o.CONTRACT_SPRICE,s.RATE=o.RATE_A,this.contractpriceObj.CList.push(s)}),this.loadingService.hide()}else this.loadingService.hide()})}Reset(){this.ShowMore=!0,this._trnMainService.disableNepaliDate=!1,this.modeTitle="Contract Pricing: Customer Wise Entry",this.InitialFormLoad(),this.Mode="ADD",this.contractpriceObj={},this.contractpriceObj.CList=[],this.contractpriceObj.DiscountType="FLAT",this.contractpriceObj.CONTRACTPRICETYPE="CUSTOMER",this.contractpriceObj.PRICEMODE=1,null==this.contractpriceObj.CList&&(this.contractpriceObj.CList=[]);try{var e={};e.DiscountType=2==this.contractpriceObj.PRICEMODE?"DISCOUNT":"FLAT",this.contractpriceObj.CList.push(e)}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n)?.focus()},50),this.contractpriceObj.CList.forEach(i=>{i.ISACTIVE=1})}clearRow(){confirm("Are you sure you want to delete the Row? ")&&(this.contractpriceObj.CList.splice(this.activerowIndex,1),0===this.contractpriceObj.CList.length&&this.nextRow())}cancel(){console.log("@@returnUrl");try{this.router.navigate(["/pages/dashboard"])}catch(e){console.log(e),this.alertService.info(e)}}handleKeyDownboardEvent(e){"ControlLeft"==e.code||"ControlRight"==e.code?(e.preventDefault(),this.showSecondaryButtons=!0):"F2"==e.code?(e.preventDefault(),this.showFileUploadPopUp()):"F3"==e.code?(e.preventDefault(),this.Reset()):"F6"==e.code?(e.preventDefault(),this.onSave()):"F4"==e.code?(e.preventDefault(),this.onViewclicked()):"F7"==e.code&&(e.preventDefault(),this.onEditclicked())}handleKeyUpboardEvent(e){("ControlLeft"==e.code||"ControlRight"==e.code)&&(e.preventDefault(),this.showSecondaryButtons=!1)}onDeleteClick(){console.log("Reached inside"),confirm("Are you sure you want to delete? ")&&this.masterService.deleteContractPrice(this.contractpriceObj.CMID).subscribe(e=>{console.log("Delete Contract Price",e),"ok"==e.status?(this.alertService.success("Contract Deleted Succesfully"),this.Reset()):this.alertService.info("Couldn't delete contract")})}onChangeMode(){"FLAT"==this.contractpriceObj.CList[this.activerowIndex].DiscountType&&(this.contractpriceObj.CList[this.activerowIndex].DISCOUNT=0),"DISCOUNT"==this.contractpriceObj.CList[this.activerowIndex].DiscountType&&(this.contractpriceObj.CList[this.activerowIndex].CONTRACT_SPRICE=0)}showFileUploadPopUp(){this.fileUploadPopup.show()}fileUploadSuccess(e){this.contractpriceObj.CList=[];let n=e.result;n.length>0&&n.forEach(i=>{let o={};o.CMID=i.CMID,o.CUSTID=i.CUSTID,o.ITEMCODE=i.ITEMCODE,o.MCODE=i.MCODE,o.ITEMNAME=i.ITEMNAME,o.UNIT=i.UNIT,o.MRP=i.MRP,o.ISACTIVE=i.ISACTIVE,o.ISVAT=i.VAT,o.DiscountType=i.DiscountType,o.DISCOUNT=i.DISCOUNT,o.CONTRACT_SPRICE=i.CONTRACT_SPRICE,o.RATE=i.rate,this.contractpriceObj.CList.push(o)})}onSelectMode(){2==this.contractpriceObj.PRICEMODE&&(this.contractpriceObj.DiscountType="DISCOUNT",this.contractpriceObj.CList[this.activerowIndex].DiscountType="DISCOUNT",this.addRowForModeChange()),1==this.contractpriceObj.PRICEMODE&&(this.contractpriceObj.DiscountType="FLAT",this.contractpriceObj.CList[this.activerowIndex].DiscountType="FLAT",this.addRowForModeChange())}addRowForModeChange(){this.contractpriceObj.CList=[];try{var e={};e.DiscountType=2==this.contractpriceObj.PRICEMODE?"DISCOUNT":"FLAT",this.contractpriceObj.CList.push(e)}catch(n){console.log(n),alert(n)}this.contractpriceObj.CList.forEach(n=>{n.ISACTIVE=1})}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(f.c),t.Y36(I.V),t.Y36(S.P),t.Y36(D.p),t.Y36(f.c),t.Y36(d.F0))},r.\u0275cmp=t.Xpm({type:r,selectors:[["contract-price"]],viewQuery:function(e,n){if(1&e&&(t.Gf(R,5),t.Gf(N,5),t.Gf(y,5),t.Gf(j,5),t.Gf(U,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.genericGridCustomer=i.first),t.iGM(i=t.CRH())&&(n.genericGridProduct=i.first),t.iGM(i=t.CRH())&&(n.genericGridViewEdit=i.first),t.iGM(i=t.CRH())&&(n.genericGridSupplier=i.first),t.iGM(i=t.CRH())&&(n.fileUploadPopup=i.first)}},hostBindings:function(e,n){1&e&&t.NdJ("keydown",function(o){return n.handleKeyDownboardEvent(o)},!1,t.evT)("keyup",function(o){return n.handleKeyUpboardEvent(o)},!1,t.evT)},decls:52,vars:23,consts:[[1,"sticky-top","row",2,"width","100%"],[1,"col-md-4"],[1,"col-md-8"],[1,"row","pull-right"],["type","submit","class","btn btn-info btn-sm",3,"click",4,"ngIf"],["type","submit","class","btn btn-info btn-sm","appOldFYearDB","",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-info btn-sm","appOldFYearDB","",3,"disabled","click",4,"ngIf"],["type","button","class","btn btn-info btn-sm",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-info","btn-sm",3,"click"],["class","row plainBackGround","style","margin-top: 0.5rem;",4,"ngIf"],[1,"row"],[1,"col-md-3","pd0",2,"margin-top","5px"],[1,"form-group","row"],[1,"col-md-3","form-control-label"],[1,"col-md-8","row"],["type","search","placeholder","Search...","name","filters",1,"form-control",2,"height","1.5rem","font-size","13px","margin-top","7px",3,"ngModel","ngModelChange"],[2,"margin-top","-5px"],[2,"height","480px","overflow-y","scroll"],[2,"margin-bottom","5px","font-size","13px","width","99%","margin-left","10px"],[2,"border-bottom","2px solid #e6e6e6","border-top","2px solid #e6e6e6","height","30px","background","#9ccae4","color","black"],[2,"font-size","12px","text-align","center","width","4%"],["scope","col","style","text-align: center;  font-size: 12px; width:28%;",4,"ngIf"],["scope","col",2,"text-align","center","font-size","12px","width","10%"],["scope","col","style","text-align: center; font-size: 12px; width:8%;",4,"ngIf"],["scope","col","style","text-align: center; width: 9%; font-size: 12px;",4,"ngIf"],["scope","col",2,"text-align","center","font-size","12px","width","9%"],["scope","col","style","text-align: center; font-size: 12px; width: 9%;",4,"ngIf"],["scope","col",2,"text-align","center","font-size","12px","width","6%"],["style","border: 1px; max-height: 25px;",3,"click",4,"ngFor","ngForOf"],[3,"popupsettings","onItemDoubleClick"],["genericGridProduct",""],["genericGridViewEdit",""],[3,"popupsettings","onUploaded"],["fileUploadPopup",""],["type","submit","appOldFYearDB","",1,"btn","btn-info","btn-sm",3,"disabled","click"],["isOldFYearDB","appOldFYearDB"],["type","button","appOldFYearDB","",1,"btn","btn-info","btn-sm",3,"disabled","click"],["type","button",1,"btn","btn-info","btn-sm",3,"click"],[1,"row","plainBackGround",2,"margin-top","0.5rem"],[1,"form-group-row"],[1,"form-control-label",2,"width","108px"],["type","text","id","pricename","autocomplete","off",2,"width","72%","height","24px",3,"ngModel","disabled","ngModelChange"],[2,"margin-top","5px"],[2,"width","72%","height","24px",3,"ngModel","disabled","ngModelChange"],["value","CUSTOMER"],["value","SUPPLIER"],[1,"col-md-4",2,"font-size","13px"],[1,"row",2,"margin-left","80px !important"],[2,"display","flex"],[1,"form-control-label",2,"width","70px"],["type","date",2,"width","40%","height","24px",3,"ngModel","disabled","ngModelChange","change"],[2,"margin-left","5px","width","33%","height","30px"],["name","nepaliDateFrom",3,"id","label","ngModel","disable","change","ngModelChange"],[2,"margin-top","5px","display","flex"],["name","nepaliDateto",3,"id","disable","label","ngModel","change","ngModelChange"],["type","radio","name","item",3,"ngModel","value","disabled","ngModelChange","change"],["scope","col",2,"text-align","center","font-size","12px","width","28%"],["scope","col",2,"text-align","center","font-size","12px","width","8%"],["scope","col",2,"text-align","center","width","9%","font-size","12px"],[2,"border","1px","max-height","25px",3,"click"],["id","sn",2,"line-height","21px","text-align","center","border","1px solid #e6e6e6"],[2,"line-height","21px","text-align","center","border","1px solid #e6e6e6"],["type","text","placeholder","Please Enter to Select","autocomplete","off","readonly","true",2,"height","25px","width","100% !important",3,"id","ngModel","disabled","keydown.enter","ngModelChange","keydown.Shift.Delete"],[2,"width","95%","height","25px",3,"id","ngModel","disabled","ngModelChange","change"],["value","FLAT",4,"ngIf"],["value","DISCOUNT"],["style","line-height: 21px; text-align: center;border: 1px solid #e6e6e6;",4,"ngIf"],["style","line-height: 21px; text-align: right;border: 1px solid #e6e6e6;",4,"ngIf"],[2,"line-height","21px","text-align","right","border","1px solid #e6e6e6"],["type","number","autocomplete","off",2,"height","25px","width","100% !important",3,"id","ngModel","disabled","ngModelChange","keydown.enter","keydown.tab"],["type","checkbox",2,"height","18px","width","19% !important",3,"id","ngModel","disabled","change","ngModelChange"],["value","FLAT"],["type","number","autocomplete","off",2,"height","25px","width","100% !important",3,"id","disabled","ngModel","ngModelChange","keydown.enter","keydown.tab"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5"),t._uU(3),t.qZA()(),t.TgZ(4,"div",2)(5,"div",3),t.YNc(6,Z,2,0,"button",4),t.YNc(7,L,3,1,"button",5),t.YNc(8,W,3,1,"button",5),t.YNc(9,k,2,0,"button",4),t.YNc(10,G,3,1,"button",6),t.YNc(11,F,2,0,"button",7),t.TgZ(12,"button",8),t.NdJ("click",function(){return n.cancel()}),t._uU(13,"Back"),t.qZA()()()(),t.YNc(14,J,34,22,"div",9),t.TgZ(15,"div")(16,"div",10)(17,"div",11)(18,"div",12)(19,"label",13),t._uU(20,"Search:"),t.qZA(),t.TgZ(21,"div",14)(22,"input",15),t.NdJ("ngModelChange",function(o){return n.filter=o}),t.qZA()()()()()(),t.TgZ(23,"div")(24,"div",16)(25,"div",17)(26,"table",18)(27,"thead")(28,"tr",19)(29,"th",20),t._uU(30,"SNo."),t.qZA(),t.YNc(31,B,2,0,"th",21),t.YNc(32,V,2,0,"th",21),t.TgZ(33,"th",22),t._uU(34,"PRICING MODE"),t.qZA(),t.YNc(35,Y,2,0,"th",23),t.YNc(36,H,4,0,"th",24),t.YNc(37,K,2,0,"th",24),t.TgZ(38,"th",25),t._uU(39,"DISCOUNT(%)"),t.qZA(),t.YNc(40,Q,4,0,"th",26),t.TgZ(41,"th",27),t._uU(42,"IS-ACTIVE"),t.qZA()()(),t.TgZ(43,"tbody"),t.YNc(44,et,18,18,"tr",28),t.ALo(45,"searchDatas"),t.qZA()()()()(),t.TgZ(46,"generic-popup-grid",29,30),t.NdJ("onItemDoubleClick",function(o){return n.onProductSelected(o)}),t.qZA(),t.TgZ(48,"generic-popup-grid",29,31),t.NdJ("onItemDoubleClick",function(o){return n.onContactPriceSelected(o)}),t.qZA(),t.TgZ(50,"file-uploader-popup",32,33),t.NdJ("onUploaded",function(o){return n.fileUploadSuccess(o)}),t.qZA()),2&e&&(t.xp6(3),t.AsE("",n.modeTitle," [",n.Mode,"]"),t.xp6(3),t.Q6J("ngIf",!n.showSecondaryButtons),t.xp6(1),t.Q6J("ngIf",!n.showSecondaryButtons),t.xp6(1),t.Q6J("ngIf",!n.showSecondaryButtons),t.xp6(1),t.Q6J("ngIf",!n.showSecondaryButtons),t.xp6(1),t.Q6J("ngIf","VIEW"==n.Mode),t.xp6(1),t.Q6J("ngIf",n.showSecondaryButtons),t.xp6(3),t.Q6J("ngIf",n.ShowMore),t.xp6(8),t.Q6J("ngModel",n.filter),t.xp6(9),t.Q6J("ngIf",1==n.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf",2==n.contractpriceObj.PRICEMODE),t.xp6(3),t.Q6J("ngIf",1==n.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf",1==n.contractpriceObj.PRICEMODE),t.xp6(1),t.Q6J("ngIf",1==n.contractpriceObj.PRICEMODE),t.xp6(3),t.Q6J("ngIf",1==n.contractpriceObj.PRICEMODE),t.xp6(4),t.Q6J("ngForOf",t.xi3(45,20,n.contractpriceObj.CList,n.filter)),t.xp6(2),t.Q6J("popupsettings",n.gridPopupSettingsForproduct),t.xp6(2),t.Q6J("popupsettings",n.gridPopupSettingsForView),t.xp6(2),t.Q6J("popupsettings",n.fileUploadPopupSettings))},dependencies:[l.sg,l.O5,h.YN,h.Kr,h.Fj,h.wV,h.Wl,h.EJ,h._,h.JJ,h.On,A.Zl,P.H,v.v,E.U,w],styles:["input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{border:1px solid #cbcbcb;border-radius:3px;height:30px;color:#000}label[_ngcontent-%COMP%]{width:62px;height:25px;font-size:13px}.form-control[_ngcontent-%COMP%]{font-size:13px}td[_ngcontent-%COMP%]{border:1px solid #e6e6e6}input[_ngcontent-%COMP%]{padding:8px}"]}),r})()},{path:"item-wise-entry",component:(()=>{class r{constructor(e,n,i,o,s,O){this.alertService=e,this.loadingService=n,this.masterService=i,this._trnMainService=o,this._alertService=s,this.router=O,this.ShowMore=!1,this.showStockedQuantityOnly=0,this.activerowIndex=0,this.contractpriceObj={},this.itemWiseObj={},this.disableOnSave=!0,this.gridPopupSettingsForCustomer=new T.sG,this.gridPopupSettingsForproduct=new T.sG}ngOnInit(){this.Reset(),this.contractpriceObj.CList[this.activerowIndex].ISACTIVE=1,this.contractpriceObj.CONTRACTPRICETYPE="Customer Contract Pricing",this.itemWiseObj.CONTRACTPRICETYPE="Cus"}showMore(){this.ShowMore=!this.ShowMore}CusWiseEntry(){console.log("Reached inside");try{this.router.navigate(["/pages/masters/Contract-price"])}catch{}}itemWiseEntry(){console.log("Reached inside");try{this.router.navigate(["./pages/masters/Contract-price/item-wise-entry",{mode:"add",returnUrl:this.router.url}])}catch{}}rowClick(e){this.activerowIndex=e}addRow(){if(""==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].ITEMNAME||null==this.contractpriceObj.CList[this.activerowIndex].MRP||null==this.contractpriceObj.CList[this.activerowIndex].MRP)return void this.alertService.warning("Please Select the Item Name.");if(null==this.contractpriceObj.CList[this.activerowIndex].DISCOUNT||null==this.contractpriceObj.CList[this.activerowIndex].DISCOUNT)return void this.alertService.warning("Please Enter the Discount rate.");null==this.contractpriceObj.CList&&(this.contractpriceObj.CList=[]);try{this.contractpriceObj.CList.push({})}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n).focus()},50),this.contractpriceObj.CList.forEach(i=>{i.ISACTIVE=1})}nextRow(){null==this.contractpriceObj.CList&&(this.contractpriceObj.CList=[]);try{this.contractpriceObj.CList.push({})}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n).focus()},50),this.contractpriceObj.CList.forEach(i=>{i.ISACTIVE=1})}itemEnterCommand(){this.getProductList(),this.genericGridProduct.show()}onCustomerSelected(e){this.contractpriceObj.CustID=e.ACID,this.contractpriceObj.CustName=e.ACNAME,this.contractpriceObj.ADDRESS=e.ADDRESS,this.contractpriceObj.VAT=e.VATNO,this.masterService.focusAnyControl("itemname"+this.activerowIndex)}getCustomersList(){this.gridPopupSettingsForCustomer={title:"Customers",apiEndpoints:"/getAccountPagedListByPType/PA/C",defaultFilterIndex:0,useDefinefilterValue:this._trnMainService.TrnMainObj.BILLTO,columns:[{key:"ACNAME",title:"NAME",hidden:!1,noSearch:!1},{key:"VATNO",title:"VAT No.",hidden:!1,noSearch:!1},{key:"ADDRESS",title:"ADDRESS",hidden:!1,noSearch:!1},{key:"PHONE",title:"Mobile No.",hidden:!1,noSearch:!1}]}}ProductList(e){this.activerowIndex=e,""==this.contractpriceObj.CustName||null==this.contractpriceObj.CustName||null==this.contractpriceObj.CustName?(this.alertService.warning("Please Select the Customer"),setTimeout(()=>{document.getElementById("custname").focus()},1e3),this.genericGridProduct.hide()):(this.getProductList(),this.genericGridProduct.show())}getProductList(){this.gridPopupSettingsForproduct={title:"PRODUCTS",apiEndpoints:`/getMenuitemWithStockPagedList/${this.showStockedQuantityOnly}/A/all/NO/${this._trnMainService.userProfile.userWarehouse}`,defaultFilterIndex:1,useDefinefilterValue:"",columns:[{key:"MENUCODE",title:"PRODUCT CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"DESCRIPTION",hidden:!1,noSearch:!1},{key:"BASEUNIT",title:"UNIT",hidden:!1,noSearch:!0},{key:"MRP",title:"MRP",hidden:!1,noSearch:!0,alignment:"right",pipe:!0}]},this.genericGridProduct.show()}onProductSelected(e){console.log("on prodcut select",e.MCODE,e.MENUCODE,this.itemWiseObj.CONTRACTPRICETYPE),this.itemWiseObj.ITEMNAME=e.DESCA,this.itemWiseObj.MCODE=e.MCODE,this.itemWiseObj.ISVAT=e.ISVAT,this.itemWiseObj.MRP=e.MRP,this.loadingService.show("Getting contracts assigned to this item..."),this.masterService.masterGetmethod(`/getItemWiseContract/${e.MCODE}/${this.itemWiseObj.CONTRACTPRICETYPE}`).subscribe(n=>{console.log("on item seleceted",n),"ok"==n.status?(this.loadingService.hide(),console.log("RESSS",n.result),this.itemWiseObj.contractList=n.result,this.itemWiseObj.contractList.forEach(i=>{i.ISACTIVE=1})):"error2"==n.status&&(this.loadingService.hide(),this.alertService.info(n.result.error.result))},n=>{this.loadingService.hide()})}onSave(){this.Mode="NEW",console.log(" TABLE SAVE VALUE",this.itemWiseObj);try{this.submitSave()}catch(e){alert(e)}}submitSave(){this.masterService.updateItemWiseContract(this.Mode,this.itemWiseObj).subscribe(e=>{console.log("item wise entry result",e),"ok"==e.status?(this.loadingService.hide(),this.alertService.success("ITEM WISE Saved Successfully !"),this.Reset()):(this.loadingService.hide(),this.alertService.info(e.result.error))})}removeInvalidRows(){this.contractpriceObj.CList=this.contractpriceObj.CList.filter(e=>null!=e.ITEMCODE&&""!=e.ITEMCODE)}onEditclicked(){this.Mode="EDIT"}Reset(){this.ShowMore=!0,this.modeTitle="Contract Pricing:Item Wise Entry",this.Mode="ADD",this.itemWiseObj={},this.itemWiseObj.contractList=[],this.itemWiseObj.ITEMNAME="",this.itemWiseObj.CONTRACTPRICETYPE="CUSTOMER",null==this.itemWiseObj.contractList&&(this.itemWiseObj.contractList=[]);try{this.itemWiseObj.contractList.push({})}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("itemname"+n)?.focus()},50),this.itemWiseObj.contractList.forEach(i=>{i.ISACTIVE=1})}clearRow(){confirm("Are you sure you want to delete the Row? ")&&(this.contractpriceObj.CList.splice(this.activerowIndex,1),0===this.contractpriceObj.CList.length&&this.nextRow())}cancel(){console.log("@@returnUrl");try{this.router.navigate(["/pages/dashboard"])}catch(e){console.log(e),this.alertService.info(e)}}onNewSRateEntry(e){console.log("New_SRate changed",e),0!=e?(this.New_Srate=!0,document.getElementById("NewDisrate"+this.activerowIndex).setAttribute("disabled","disabled"),this.itemWiseObj.contractList[this.activerowIndex].NEW_DRATE=0,this.itemWiseObj.contractList[this.activerowIndex].DISCOUNTTYPE="FLAT"):0==e?(console.log("@@New_SRate",e),document.getElementById("NewDisrate"+this.activerowIndex).removeAttribute("disabled"),this.itemWiseObj.contractList[this.activerowIndex].DISCOUNTTYPE=""):(this.New_Srate=!1,document.getElementById("NewSrate"+this.activerowIndex).removeAttribute("disabled"))}onNewDisRateEntry(e){console.log("New_DisRate changed",e),0!=e?(this.New_disrate=!0,document.getElementById("NewSrate"+this.activerowIndex).setAttribute("disabled","disabled"),this.itemWiseObj.contractList[this.activerowIndex].NEW_SRATE=0,this.itemWiseObj.contractList[this.activerowIndex].DISCOUNTTYPE="DISCOUNT"):0==e?(document.getElementById("NewSrate"+this.activerowIndex).removeAttribute("disabled"),this.itemWiseObj.contractList[this.activerowIndex].DISCOUNTTYPE=""):(this.New_disrate=!1,document.getElementById("NewDisrate"+this.activerowIndex).removeAttribute("disabled"))}handleKeyUpboardEvent(e){("ControlLeft"==e.code||"ControlRight"==e.code)&&(e.preventDefault(),this.showSecondaryButtons=!1)}handleKeyDownboardEvent(e){("ControlLeft"==e.code||"ControlRight"==e.code)&&(e.preventDefault(),this.showSecondaryButtons=!0)}}return r.\u0275fac=function(e){return new(e||r)(t.Y36(f.c),t.Y36(I.V),t.Y36(S.P),t.Y36(D.p),t.Y36(f.c),t.Y36(d.F0))},r.\u0275cmp=t.Xpm({type:r,selectors:[["ItemWise-Contractprice"]],viewQuery:function(e,n){if(1&e&&(t.Gf(nt,5),t.Gf(ot,5)),2&e){let i;t.iGM(i=t.CRH())&&(n.genericGridCustomer=i.first),t.iGM(i=t.CRH())&&(n.genericGridProduct=i.first)}},hostBindings:function(e,n){1&e&&t.NdJ("keyup",function(o){return n.handleKeyUpboardEvent(o)},!1,t.evT)("keydown",function(o){return n.handleKeyDownboardEvent(o)},!1,t.evT)},decls:59,vars:8,consts:[[1,"sticky-top","row"],[1,"col-md-3"],[2,"display","flex"],[1,"btn","btn-info",3,"click"],[2,"margin-left","-105px"],[1,"col-md-6"],[1,"row","pull-right"],["type","submit",1,"btn","btn-info","btn-sm",3,"click"],["type","button",1,"btn","btn-info","btn-sm"],["type","button","class","btn btn-info btn-sm",4,"ngIf"],["class","row plainBackGround","style","margin-top: 0.5rem;",4,"ngIf"],[2,"margin-top","10px"],[2,"height","480px","overflow-y","scroll"],[2,"margin-bottom","5px","font-size","13px","width","99%","margin-left","10px"],[2,"border-bottom","2px solid #e6e6e6","border-top","2px solid #e6e6e6","height","30px","background","#9ccae4","color","black"],[2,"font-size","12px","text-align","center"],["scope","col",2,"text-align","center","font-size","12px","width","21%"],["scope","col",2,"text-align","center","font-size","12px","width","13%"],["scope","col",2,"text-align","center","font-size","12px"],["scope","col",2,"text-align","center","width","9%","font-size","12px"],["scope","col",2,"text-align","center","font-size","12px","width","9%"],["style","border: 1px; max-height: 25px;",3,"click",4,"ngFor","ngForOf"],[3,"popupsettings","onItemDoubleClick"],["genericGridCustomer",""],["genericGridProduct",""],[1,"row","plainBackGround",2,"margin-top","0.5rem"],[1,"col-md-4"],[1,"form-group-row"],[1,"form-control-label"],["type","text","id","custname","placeholder","Press Enter to Select","autocomplete","off",2,"width","65%","height","24px",3,"ngModel","ngModelChange","keydown.enter"],[1,"row",2,"margin-left","60px !important"],[2,"width","137px"],[2,"width","200px","height","25px",3,"ngModel","ngModelChange"],["value","CUSTOMER"],["value","SUPPLIER"],[2,"margin-left","146px"],[1,"legend-class"],[2,"margin-left","44px","margin-top","-17px"],[2,"border","1px","max-height","25px",3,"click"],["id","sn",2,"line-height","21px","text-align","center","border","1px solid #e6e6e6"],[2,"line-height","21px","text-align","left","border","1px solid #e6e6e6"],[2,"line-height","21px","text-align","right","border","1px solid #e6e6e6"],[2,"line-height","21px","text-align","center","border","1px solid #e6e6e6"],["type","number",2,"height","25px","text-align","right",3,"id","ngModel","ngModelChange"],["type","checkbox",2,"height","25px",3,"id","ngModel","disabled","change","ngModelChange"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),t.NdJ("click",function(){return n.itemWiseEntry()}),t.TgZ(4,"span"),t._uU(5,"Item Wise Entry"),t.qZA()(),t.TgZ(6,"button",3),t.NdJ("click",function(){return n.CusWiseEntry()}),t.TgZ(7,"span"),t._uU(8,"Customer Wise Entry"),t.qZA()()()(),t.TgZ(9,"div",1)(10,"h5",4),t._uU(11),t.qZA()(),t.TgZ(12,"div",5)(13,"div",6)(14,"button",7),t.NdJ("click",function(){return n.Reset()}),t._uU(15,"Reset"),t.qZA(),t.TgZ(16,"button",7),t.NdJ("click",function(){return n.onSave()}),t._uU(17,"Save"),t.qZA(),t.TgZ(18,"button",8),t._uU(19,"Delete"),t.qZA(),t.YNc(20,rt,2,0,"button",9),t.YNc(21,ct,2,0,"button",9),t.TgZ(22,"button",7),t.NdJ("click",function(){return n.cancel()}),t._uU(23,"Back"),t.qZA()()()(),t.YNc(24,st,23,3,"div",10),t.TgZ(25,"div")(26,"div",11)(27,"div",12)(28,"table",13)(29,"thead")(30,"tr",14)(31,"th",15),t._uU(32,"SNo."),t.qZA(),t.TgZ(33,"th",16),t._uU(34,"CUSTOMER NAME"),t.qZA(),t.TgZ(35,"th",17),t._uU(36,"ADDRESS"),t.qZA(),t.TgZ(37,"th",18),t._uU(38,"VAT NO"),t.qZA(),t.TgZ(39,"th",19),t._uU(40,"MRP"),t.qZA(),t.TgZ(41,"th",20),t._uU(42,"Discount Type"),t.qZA(),t.TgZ(43,"th",20),t._uU(44,"CURRENT S-RATE"),t.qZA(),t.TgZ(45,"th",20),t._uU(46,"CURRENT Dis RATE"),t.qZA(),t.TgZ(47,"th",20),t._uU(48,"NEW S-RATE"),t.qZA(),t.TgZ(49,"th",20),t._uU(50,"NEW DIS RATE"),t.qZA(),t.TgZ(51,"th",18),t._uU(52,"IS-ACTIVE"),t.qZA()()(),t.TgZ(53,"tbody"),t.YNc(54,at,23,15,"tr",21),t.qZA()()()()(),t.TgZ(55,"generic-popup-grid",22,23),t.NdJ("onItemDoubleClick",function(o){return n.onCustomerSelected(o)}),t.qZA(),t.TgZ(57,"generic-popup-grid",22,24),t.NdJ("onItemDoubleClick",function(o){return n.onProductSelected(o)}),t.qZA()),2&e&&(t.xp6(11),t.AsE("",n.modeTitle," [",n.Mode,"]"),t.xp6(9),t.Q6J("ngIf",n.showSecondaryButtons),t.xp6(1),t.Q6J("ngIf",n.showSecondaryButtons),t.xp6(3),t.Q6J("ngIf",n.ShowMore),t.xp6(30),t.Q6J("ngForOf",n.itemWiseObj.contractList),t.xp6(1),t.Q6J("popupsettings",n.gridPopupSettingsForCustomer),t.xp6(2),t.Q6J("popupsettings",n.gridPopupSettingsForproduct))},dependencies:[l.sg,l.O5,h.YN,h.Kr,h.Fj,h.wV,h.Wl,h.EJ,h.JJ,h.On,A.Zl],styles:["legend[_ngcontent-%COMP%]{font-size:12px;color:#222;width:auto}fieldset[_ngcontent-%COMP%]{margin-bottom:1%;border:2px solid #dbd7d7;width:179px;height:40px;margin-left:250px}"]}),r})()}];let pt=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[d.Bz.forChild(lt),d.Bz]}),r})();var dt=c(71459),ht=c(55618);let ut=(()=>{class r{}return r.\u0275fac=function(e){return new(e||r)},r.\u0275mod=t.oAB({type:r}),r.\u0275inj=t.cJS({imports:[l.ez,pt,p.m,m.JX,u.Xd,g.Is,_.b.forRoot(),b.Z,dt.J,ht.c.forRoot()]}),r})()}}]);