(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[1961],{49457:function(I,x){var m;void 0!==(m=function(){"use strict";function G(t,s,_){var u=new XMLHttpRequest;u.open("GET",t),u.responseType="blob",u.onload=function(){A(u.response,s,_)},u.onerror=function(){console.error("could not download file")},u.send()}function v(t){var s=new XMLHttpRequest;s.open("HEAD",t,!1);try{s.send()}catch{}return 200<=s.status&&299>=s.status}function f(t){try{t.dispatchEvent(new MouseEvent("click"))}catch{var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(s)}}var d="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,c=d.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),A=d.saveAs||("object"!=typeof window||window!==d?function(){}:"download"in HTMLAnchorElement.prototype&&!c?function(t,s,_){var u=d.URL||d.webkitURL,h=document.createElement("a");h.download=s=s||t.name||"download",h.rel="noopener","string"==typeof t?(h.href=t,h.origin===location.origin?f(h):v(h.href)?G(t,s,_):f(h,h.target="_blank")):(h.href=u.createObjectURL(t),setTimeout(function(){u.revokeObjectURL(h.href)},4e4),setTimeout(function(){f(h)},0))}:"msSaveOrOpenBlob"in navigator?function(t,s,_){if(s=s||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(function T(t,s){return typeof s>"u"?s={autoBom:!1}:"object"!=typeof s&&(console.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}(t,_),s);else if(v(t))G(t,s,_);else{var u=document.createElement("a");u.href=t,u.target="_blank",setTimeout(function(){f(u)})}}:function(t,s,_,u){if((u=u||open("","_blank"))&&(u.document.title=u.document.body.innerText="downloading..."),"string"==typeof t)return G(t,s,_);var h="application/octet-stream"===t.type,D=/constructor/i.test(d.HTMLElement)||d.safari,M=/CriOS\/[\d]+/.test(navigator.userAgent);if((M||h&&D||c)&&typeof FileReader<"u"){var O=new FileReader;O.onloadend=function(){var w=O.result;w=M?w:w.replace(/^data:[^;]*;/,"data:attachment/file;"),u?u.location.href=w:location=w,u=null},O.readAsDataURL(t)}else{var g=d.URL||d.webkitURL,y=g.createObjectURL(t);u?u.location=y:location.href=y,u=null,setTimeout(function(){g.revokeObjectURL(y)},4e4)}});d.saveAs=A.saveAs=A,I.exports=A}.apply(x,[]))&&(I.exports=m)},55618:(I,x,p)=>{"use strict";p.d(x,{c:()=>t});var b=p(88692),m=p(71800),T=p(72533),G=p(18488),v=p(53074),f=p(20092),d=p(47766),c=p(64537);let A=(()=>{class s{static forRoot(){return{ngModule:s}}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275mod=c.oAB({type:s}),s.\u0275inj=c.cJS({imports:[b.ez,f.u5,f.UX,T.JX]}),s})(),t=(()=>{class s{static forRoot(){return{ngModule:s,providers:[v.P,G.G]}}}return s.\u0275fac=function(u){return new(u||s)},s.\u0275mod=c.oAB({type:s}),s.\u0275inj=c.cJS({imports:[b.ez,m.zk.forRoot(),T.JX,b.ez,f.u5,f.UX,d.e,A.forRoot()]}),s})()},82738:(I,x,p)=>{"use strict";p.d(x,{b:()=>d});var b=p(88692),m=p(72533),T=p(87584),G=p(71800),v=p(53074),f=p(64537);let d=(()=>{class c{static forRoot(){return{ngModule:c,providers:[v.P,T.p]}}}return c.\u0275fac=function(t){return new(t||c)},c.\u0275mod=f.oAB({type:c}),c.\u0275inj=f.cJS({imports:[b.ez,G.zk.forRoot(),m.JX]}),c})()},81961:(I,x,p)=>{"use strict";p.r(x),p.d(x,{RateGroupModule:()=>wt});var b=p(46543),m=p(88692),T=p(72533),G=p(12640),v=p(82738),f=p(71800),d=p(54536),c=p(7976),A=p(47767),t=p(64537),s=p(67311),_=p(35732),u=p(79765),h=p(67297),D=p(71180);let M=(()=>{class n{constructor(e,o,r,i){this.http=e,this.activatedRoute=o,this.authService=r,this.state=i;const l=this.state.getGlobalSetting("apiUrl");l&&l.length>0&&(this.apiUrl=l)}getRequestOptions(){return new _.WM({"Content-type":"application/json",Authorization:this.authService.getAuth().token,"X-Requested-With":"XMLHttpRequest"})}saveRateGroup(e,o){let r={status:"error",result:""},i=new u.xQ;const l={headers:this.getRequestOptions(),method:"post"};return this.http.post(this.apiUrl+"/saveRateGroup",{mode:e,data:o},l).subscribe(C=>{let E=C;"ok"==E.status?(r.status="ok",r.result=E.result,i.next(r),i.unsubscribe()):(r.status="error1",r.result=E.result,i.next(r),i.unsubscribe())},C=>{r.status="error2",r.result=C,i.next(r),i.unsubscribe()}),i}getRateGroupList(){return this.http.get(this.apiUrl+"/getAllRateGroupList")}getRateGroupByID(e){return new u.xQ,this.http.post(this.apiUrl+"/getRateGroupByID",{mode:"query",data:{rateGroupID:e}})}deleteRateGroup(e){let o={status:"error",result:""},r=new u.xQ,i={mode:"query",data:{RateGroup_ID:e}};const l={headers:this.authService.getRequestOption(),method:"post"};return this.http.post(this.apiUrl+"/deleteRateGroup",i,l).subscribe(R=>{r.next(R),r.unsubscribe()},R=>{o.status="error",o.result=R,r.next(o),r.unsubscribe()}),r}downloadRateGroupExcel(e,o){return this.http.get(this.apiUrl+`/getRateGroupMasterExcelFile?ID=${e}&TYPE=${o}`,{responseType:"blob"})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(_.eN),t.LFG(c.gz),t.LFG(h.e),t.LFG(D.q))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})();var O=p(53074),g=p(20092);let y=(()=>{class n{transform(e,o){if(e)return o?e.filter(r=>{const i=o.replace(/[^A-Z0-9]/gi,"").toLowerCase(),l=r.RateGroup_Name?r.RateGroup_Name.replace(/[^A-Z0-9]/gi,"").toLowerCase():"",R=r.MENUCODE?r.MENUCODE.replace(/[^A-Z0-9]/gi,"").toLowerCase():"",C=r.DESCA?r.DESCA.replace(/[^A-Z0-9]/gi,"").toLowerCase():"",E=r.MCat?r.MCat.replace(/[^A-Z0-9]/gi,"").toLowerCase():"";if(-1!==l.indexOf(i)||-1!==R.indexOf(i)||-1!==C.indexOf(i)||-1!==E.indexOf(i))return r}):e}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"searchData",type:n,pure:!1}),n})();function w(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td",20),t._uU(2),t.qZA(),t.TgZ(3,"td",21),t._uU(4),t.qZA(),t.TgZ(5,"td",22),t._uU(6),t.qZA(),t.TgZ(7,"td",22),t._uU(8),t.qZA(),t.TgZ(9,"td",23)(10,"a",24),t.NdJ("click",function(){const i=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onViewClick(i))}),t._uU(11,"View"),t.qZA(),t.TgZ(12,"a",24),t.NdJ("click",function(){const i=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEditClicked(i))}),t._uU(13,"Edit"),t.qZA(),t.TgZ(14,"a",24),t.NdJ("click",function(){const i=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onDeleteClicked(i))}),t._uU(15,"Delete"),t.qZA()()()}if(2&n){const e=a.$implicit,o=a.index,r=t.oxw(2);t.xp6(2),t.Oqu(o+1+(r.currentPage-1)*r.itemsPerPage),t.xp6(2),t.Oqu(e.RateGroup_Name),t.xp6(2),t.Oqu(e.RateGroup_ID),t.xp6(2),t.Oqu(e.RateGroup_Type)}}function j(n,a){if(1&n&&(t.ynx(0),t.YNc(1,w,16,4,"tr",19),t.ALo(2,"searchData"),t.BQk()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",t.xi3(2,1,e.rategroupList,e.filter))}}function S(n,a){1&n&&(t.ynx(0),t.TgZ(1,"tr")(2,"td",25)(3,"div",26),t._uU(4,"Rate Group Information are unavailable."),t.qZA()()(),t.BQk())}let P=(()=>{class n extends A.c{constructor(e,o,r,i,l){super(r),this.router=e,this.alertService=o,this.injector=r,this.rateGroupservice=i,this.masterRepo=l,this.isLoader=!0,this.currentPage=1,this.itemsPerPage=50,this.offset=0,this.rategroupList=[]}ngOnInit(){this.rateGroupservice.getRateGroupList().subscribe(e=>{e?(console.log("res",e),this.isLoader=!1,this.rategroupList=e||[]):(this.isLoader=!1,this.rategroupList=[],this.errorMessage="Something went wrong.")},e=>{this.isLoader=!1,this.rategroupList=[],this.errorMessage="Something went wrong."})}onEditClicked(e){try{if(0==this.masterRepo.checkIsBranch())return void this.alertService.warning("Cannot edit rate Group in branch office");this.router.navigate(["./pages/masters/rategroup/add-rate-group",{rateGroupID:e.RateGroup_ID,mode:"edit",returnUrl:this.router.url}])}catch(o){this.alertService.error(o)}}onViewClick(e){try{this.router.navigate(["./pages/masters/rategroup/add-rate-group",{rateGroupID:e.RateGroup_ID,mode:"view",returnUrl:this.router.url}])}catch(o){console.log(o),alert(o)}}onDeleteClicked(e){confirm("Are you sure you want to delete "+e.RateGroup_Name+" ?")&&this.rateGroupservice.deleteRateGroup(e.RateGroup_ID).subscribe(o=>{"ok"==o.status?(this.alertService.info(o.result),this.rateGroupservice.getRateGroupList().subscribe(r=>{r?(this.isLoader=!1,this.rategroupList=r||[]):(this.rategroupList=[],this.errorMessage="something is wrong.")})):this.alertService.error(o.result.error)},o=>{this.alertService.error(o.error)})}rategroupPagination(e){this.isLoader=!0,this.currentPage=e;const o=this;window.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{o.isLoader=!1},500)}addRateGroup(){try{if(0==this.masterRepo.checkIsBranch())return void this.alertService.warning("Cannot add rate group in branch office");this.router.navigate(["./pages/masters/rategroup/add-rate-group",{mode:"add",returnUrl:this.router.url}])}catch(o){this.alertService.error(o)}}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.F0),t.Y36(s.c),t.Y36(t.zs3),t.Y36(M),t.Y36(O.P))},n.\u0275cmp=t.Xpm({type:n,selectors:[["rategroup-list"]],features:[t.qOj],decls:35,vars:6,consts:[[1,"row","col-md-12"],[1,"col-md-4"],[1,"col-md-8"],["routerLink","/pages/dashboard",1,"btn","btn-info","pull-right",2,"font-size","12px"],[1,"btn","btn-info","pull-right",2,"font-size","12px",3,"click"],[1,"row",2,"align-items","center"],[1,"col-md-12","col-sm-8",2,"margin-top","0.5rem"],[1,"card",2,"margin","auto","width","63rem"],[1,"card-header"],[2,"width","25%"],["type","search","placeholder","Search...","name","filter",1,"form-control",2,"height","1.5rem","font-size","13px",3,"ngModel","ngModelChange"],[1,"card-body"],[1,"table","table-striped"],[2,"position","sticky","top","0","line-height","1.5rem"],["scope","col",2,"width","3%"],["scope","col",2,"width","18%"],["scope","col",2,"width","8%"],["scope","col",2,"text-align","center","width","15%"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"width","3%"],[2,"width","18%"],[2,"width","8%"],[2,"width","15%","text-align","center"],[1,"btn","btn-sm","btn-info","mr-1","btn-sm",2,"width","60px","color","white",3,"click"],["colspan","7"],[1,"font-weight-bold"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5"),t._uU(3,"Rate Group Master"),t.qZA()(),t.TgZ(4,"div",2)(5,"button",3),t._uU(6,"Back"),t.qZA(),t.TgZ(7,"button",4),t.NdJ("click",function(){return o.addRateGroup()}),t._uU(8,"Add Rate Group"),t.qZA()()(),t.TgZ(9,"div",5)(10,"div",6)(11,"div",7)(12,"div",8)(13,"span"),t._uU(14,"Rate Group Lists"),t.qZA(),t.TgZ(15,"div",9)(16,"input",10),t.NdJ("ngModelChange",function(i){return o.filter=i}),t.qZA()()(),t.TgZ(17,"div",11)(18,"table",12)(19,"thead")(20,"tr",13)(21,"th",14),t._uU(22,"S.N"),t.qZA(),t.TgZ(23,"th",15),t._uU(24,"Rate Group Name"),t.qZA(),t.TgZ(25,"th",16),t._uU(26,"Rate Group ID"),t.qZA(),t.TgZ(27,"th",16),t._uU(28,"Rate Group Type"),t.qZA(),t.TgZ(29,"th",17),t._uU(30,"Action"),t.qZA()()(),t.TgZ(31,"tbody"),t.YNc(32,j,3,4,"ng-container",18),t.YNc(33,S,5,0,"ng-container",18),t.ALo(34,"searchData"),t.qZA()()()()()()),2&e&&(t.xp6(16),t.Q6J("ngModel",o.filter),t.xp6(16),t.Q6J("ngIf",o.rategroupList&&o.rategroupList.length>0),t.xp6(1),t.Q6J("ngIf",o.rategroupList&&0===t.xi3(34,3,o.rategroupList,o.filter).length))},dependencies:[m.sg,m.O5,g.Fj,g.JJ,g.On,c.rH,y],styles:[".card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.card-header[_ngcontent-%COMP%]:after{display:none}.card-body[_ngcontent-%COMP%]{padding:5px!important;max-height:455px!important}.main-title[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin:60px 0}.scroll-touch[_ngcontent-%COMP%]{-webkit-overflow-scrolling:touch!important}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.1rem!important}.sticky-top[_ngcontent-%COMP%]{margin-top:60px;height:100vh}tbody[_ngcontent-%COMP%]{display:block;height:59vh;overflow:auto}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}th[_ngcontent-%COMP%]{font-size:15px}td[_ngcontent-%COMP%]{font-size:13px}.btn-sm[_ngcontent-%COMP%]{line-height:3px}.card-header[_ngcontent-%COMP%]{padding:10px 20px}.card-footer[_ngcontent-%COMP%]{height:6vh}.searchBy[_ngcontent-%COMP%]{font-size:13px;margin-left:16rem}.my-pagination[_ngcontent-%COMP%]     .ngx-pagination .current{background:#17a2b8!important;border:transparent!important;border-radius:20px!important}.my-pagination[_ngcontent-%COMP%]     .ngx-pagination .current:hover{background:#74d4e2!important;border-radius:20px!important;border:transparent!important}.my-pagination[_ngcontent-%COMP%]     .ngx-pagination a:hover, .ngx-pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#c2c2c2;border-radius:20px!important}"]}),n})();var Z=p(28698),N=p(40216),F=p(49457),U=p(248),k=p(14970);const J=["genericGrid"],L=["fileUploadPopup"];function V(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.exportClick())}),t._uU(1,"Export Rate Group"),t.qZA()}}function B(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",6),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.showImportPopup())}),t._uU(1,"Import Rate Group"),t.qZA()}}function q(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",28)(1,"label",10),t._uU(2,"Whole Sale Rate"),t.qZA(),t.TgZ(3,"input",29),t.NdJ("ngModelChange",function(r){t.CHM(e);const i=t.oxw();return t.KtG(i.rateGroupObj.ApplyWSRate=r)})("change",function(r){t.CHM(e);const i=t.oxw();return t.KtG(i.onApplyWSrate(r))}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngModel",e.rateGroupObj.ApplyWSRate)}}function Q(n,a){1&n&&(t.TgZ(0,"div",49),t._UZ(1,"div",50)(2,"div",51),t.qZA())}function Y(n,a){1&n&&t._UZ(0,"th",55)}function K(n,a){1&n&&t._UZ(0,"th",56)}function W(n,a){if(1&n&&(t.TgZ(0,"tr",52),t._UZ(1,"th",42),t.YNc(2,Y,1,0,"th",43),t.YNc(3,K,1,0,"th",44),t.TgZ(4,"th",53),t._uU(5,"Current Sales Rate (Base)"),t.qZA(),t.TgZ(6,"th",54),t._uU(7,"Sales Rate Adjustment"),t.qZA(),t.TgZ(8,"th",53),t._uU(9," Sales Rate (Rate Group)"),t.qZA()()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("ngIf","Mcode"==e.flag),t.xp6(1),t.Q6J("ngIf","Mcode"==e.flag)}}function H(n,a){1&n&&(t.TgZ(0,"th",55),t._uU(1,"Group Code"),t.qZA())}function z(n,a){1&n&&(t.TgZ(0,"th",56),t._uU(1,"Group Name"),t.qZA())}function X(n,a){1&n&&(t.TgZ(0,"th",55),t._uU(1,"Parent Code"),t.qZA())}function $(n,a){1&n&&(t.TgZ(0,"th",56),t._uU(1,"Parent Name"),t.qZA())}function tt(n,a){1&n&&(t.TgZ(0,"th",55),t._uU(1,"Item Code"),t.qZA())}function et(n,a){1&n&&(t.TgZ(0,"th",56),t._uU(1,"Item Name"),t.qZA())}function ot(n,a){1&n&&(t.TgZ(0,"th",56),t._uU(1,"Category Name"),t.qZA())}function rt(n,a){1&n&&(t.TgZ(0,"th",46),t._uU(1,"Inc-VAT"),t.qZA())}function nt(n,a){1&n&&(t.TgZ(0,"th",46),t._uU(1,"Exc-VAT"),t.qZA())}function it(n,a){1&n&&(t.TgZ(0,"th",46),t._uU(1,"Inc-VAT"),t.qZA())}function at(n,a){1&n&&(t.TgZ(0,"th",46),t._uU(1,"Exc-VAT"),t.qZA())}function st(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"td",63)(1,"input",66),t.NdJ("ngModelChange",function(r){t.CHM(e);const i=t.oxw().$implicit;return t.KtG(i.MCat=r)})("keydown.Tab",function(){t.CHM(e);const r=t.oxw().index,i=t.oxw(2);return t.KtG(i.CatkeyEvent(r))})("keydown.enter",function(){t.CHM(e);const r=t.oxw().index,i=t.oxw(2);return t.KtG(i.CatkeyEvent(r))}),t.qZA()()}if(2&n){const e=t.oxw(),o=e.index,r=e.$implicit,i=t.oxw(2);t.xp6(1),t.MGl("id","category",o,""),t.Q6J("ngModel",r.MCat)("disabled",i.disableOnView)}}function pt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"td",63)(1,"input",67),t.NdJ("ngModelChange",function(r){t.CHM(e);const i=t.oxw().$implicit;return t.KtG(i.MENUCODE=r)})("keydown.Tab",function(){t.CHM(e);const r=t.oxw().index,i=t.oxw(2);return t.KtG(i.groupKeyEvent(r))})("keydown.enter",function(){t.CHM(e);const r=t.oxw().index,i=t.oxw(2);return t.KtG(i.groupKeyEvent(r))}),t.qZA()()}if(2&n){const e=t.oxw(),o=e.index,r=e.$implicit,i=t.oxw(2);t.xp6(1),t.MGl("id","groupCode",o,""),t.Q6J("ngModel",r.MENUCODE)("disabled",i.disableOnView)}}function lt(n,a){if(1&n&&(t.TgZ(0,"td",68),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij("\xa0\xa0",e.DESCA,"")}}function ut(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"td",63)(1,"input",69),t.NdJ("ngModelChange",function(r){t.CHM(e);const i=t.oxw().$implicit;return t.KtG(i.MENUCODE=r)})("keydown.Tab",function(){t.CHM(e);const r=t.oxw().index,i=t.oxw(2);return t.KtG(i.parentKeyEvent(r))})("keydown.enter",function(){t.CHM(e);const r=t.oxw().index,i=t.oxw(2);return t.KtG(i.parentKeyEvent(r))}),t.qZA()()}if(2&n){const e=t.oxw(),o=e.index,r=e.$implicit,i=t.oxw(2);t.xp6(1),t.MGl("id","parentCode",o,""),t.Q6J("ngModel",r.MENUCODE)("disabled",i.disableOnView)}}function ct(n,a){if(1&n&&(t.TgZ(0,"td",68),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij("\xa0\xa0",e.DESCA,"")}}function dt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"td",63)(1,"input",70),t.NdJ("ngModelChange",function(r){t.CHM(e);const i=t.oxw().$implicit;return t.KtG(i.MENUCODE=r)})("keydown.Tab",function(){t.CHM(e);const r=t.oxw().index,i=t.oxw(2);return t.KtG(i.itemKeyEvent(r))})("keydown.enter",function(){t.CHM(e);const r=t.oxw().index,i=t.oxw(2);return t.KtG(i.itemKeyEvent(r))}),t.qZA()()}if(2&n){const e=t.oxw(),o=e.index,r=e.$implicit,i=t.oxw(2);t.xp6(1),t.MGl("id","itemCode",o,""),t.Q6J("ngModel",r.MENUCODE)("disabled",i.disableOnView)}}function _t(n,a){if(1&n&&(t.TgZ(0,"td",68),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij("\xa0\xa0",e.DESCA,"")}}function ht(n,a){if(1&n&&(t.TgZ(0,"td",71),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij("\xa0\xa0",t.xi3(2,1,e.RATE_INVAT,"1.2-2"),"")}}function gt(n,a){if(1&n&&(t.TgZ(0,"td",71),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij("\xa0\xa0",t.xi3(2,1,e.RATE_EXVAT,"1.2-2"),"")}}function mt(n,a){if(1&n&&(t.TgZ(0,"td",68),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij("\xa0\xa0",t.xi3(2,1,e.NEWRATE_INCVAT,"1.2-2"),"")}}function ft(n,a){if(1&n&&(t.TgZ(0,"td",68),t._uU(1),t.ALo(2,"number"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij("\xa0\xa0",t.xi3(2,1,e.NEWRATE_EXCVAT,"1.2-2"),"")}}function Rt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"tr",57),t.NdJ("click",function(){const i=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.TableRowclick(i))})("keydown.Shift.delete",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.deleteRow())}),t.TgZ(1,"td",58),t._uU(2),t.qZA(),t.YNc(3,st,2,3,"td",59),t.YNc(4,pt,2,3,"td",59),t.YNc(5,lt,2,1,"td",60),t.YNc(6,ut,2,3,"td",59),t.YNc(7,ct,2,1,"td",60),t.YNc(8,dt,2,3,"td",59),t.YNc(9,_t,2,1,"td",60),t.YNc(10,ht,3,4,"td",61),t.YNc(11,gt,3,4,"td",62),t.TgZ(12,"td",63)(13,"input",64),t.NdJ("ngModelChange",function(r){const l=t.CHM(e).$implicit;return t.KtG(l.Rate=r)})("keydown.enter",function(){const i=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.nextRow(i))})("ngModelChange",function(){const i=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEntryRate(i.Rate))})("keydown.Tab",function(){const i=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.nextRow(i))}),t.qZA()(),t.TgZ(14,"td",63)(15,"input",65),t.NdJ("ngModelChange",function(r){const l=t.CHM(e).$implicit;return t.KtG(l.Amount=r)})("ngModelChange",function(){const i=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.onEntryAmount(i.Amount))})("keydown.enter",function(){const i=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.nextRowAmount(i))})("keydown.Tab",function(){const i=t.CHM(e).index,l=t.oxw(2);return t.KtG(l.nextRowAmount(i))}),t.qZA()(),t.YNc(16,mt,3,4,"td",60),t.YNc(17,ft,3,4,"td",60),t.qZA()}if(2&n){const e=a.$implicit,o=a.index,r=t.oxw(2);t.xp6(1),t.MGl("id","sno",o,""),t.xp6(1),t.Oqu(o+1),t.xp6(1),t.Q6J("ngIf","MCAT"==r.flag),t.xp6(1),t.Q6J("ngIf","MGroup"==r.flag),t.xp6(1),t.Q6J("ngIf","MGroup"==r.flag),t.xp6(1),t.Q6J("ngIf","Parent"==r.flag),t.xp6(1),t.Q6J("ngIf","Parent"==r.flag),t.xp6(1),t.Q6J("ngIf","Mcode"==r.flag),t.xp6(1),t.Q6J("ngIf","Mcode"==r.flag),t.xp6(1),t.Q6J("ngIf","Mcode"==r.flag),t.xp6(1),t.Q6J("ngIf","Mcode"==r.flag),t.xp6(2),t.MGl("id","rate",o,""),t.Q6J("ngModel",e.Rate)("disabled",r.disableOnView),t.xp6(2),t.MGl("id","amount",o,""),t.Q6J("ngModel",e.Amount)("disabled",r.disableOnView),t.xp6(1),t.Q6J("ngIf","Mcode"==r.flag),t.xp6(1),t.Q6J("ngIf","Mcode"==r.flag)}}function Gt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",30),t.YNc(1,Q,3,0,"div",31),t.TgZ(2,"div")(3,"div",32)(4,"div",33)(5,"div",9)(6,"label",34),t._uU(7,"Search:"),t.qZA(),t.TgZ(8,"div",35)(9,"input",36),t.NdJ("ngModelChange",function(r){t.CHM(e);const i=t.oxw();return t.KtG(i.filter=r)}),t.qZA()()()()()(),t.TgZ(10,"div",37)(11,"div",38)(12,"table",39),t.YNc(13,W,10,2,"tr",40),t.TgZ(14,"tr",41)(15,"th",42),t._uU(16,"S.no."),t.qZA(),t.YNc(17,H,2,0,"th",43),t.YNc(18,z,2,0,"th",44),t.YNc(19,X,2,0,"th",43),t.YNc(20,$,2,0,"th",44),t.YNc(21,tt,2,0,"th",43),t.YNc(22,et,2,0,"th",44),t.YNc(23,ot,2,0,"th",44),t.YNc(24,rt,2,0,"th",45),t.YNc(25,nt,2,0,"th",45),t.TgZ(26,"th",46),t._uU(27,"By Percentage"),t.qZA(),t.TgZ(28,"th",46),t._uU(29,"By Amount"),t.qZA(),t.YNc(30,it,2,0,"th",45),t.YNc(31,at,2,0,"th",45),t.qZA(),t.TgZ(32,"tbody",47),t.YNc(33,Rt,18,19,"tr",48),t.ALo(34,"searchData"),t.qZA()()()()()}if(2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf","edit"==e.mode),t.xp6(8),t.Q6J("ngModel",e.filter),t.xp6(4),t.Q6J("ngIf","Mcode"==e.flag),t.xp6(4),t.Q6J("ngIf","MGroup"==e.flag),t.xp6(1),t.Q6J("ngIf","MGroup"==e.flag),t.xp6(1),t.Q6J("ngIf","Parent"==e.flag),t.xp6(1),t.Q6J("ngIf","Parent"==e.flag),t.xp6(1),t.Q6J("ngIf","Mcode"==e.flag),t.xp6(1),t.Q6J("ngIf","Mcode"==e.flag),t.xp6(1),t.Q6J("ngIf","MCAT"==e.flag),t.xp6(1),t.Q6J("ngIf","Mcode"==e.flag),t.xp6(1),t.Q6J("ngIf","Mcode"==e.flag),t.xp6(5),t.Q6J("ngIf","Mcode"==e.flag),t.xp6(1),t.Q6J("ngIf","Mcode"==e.flag),t.xp6(2),t.Q6J("ngForOf",t.xi3(34,15,e.rateGroupObj.RateGroup_Detail,e.filter))}}function bt(n,a){if(1&n&&(t.TgZ(0,"option",83),t._uU(1),t.qZA()),2&n){const e=a.$implicit;t.Q6J("ngValue",e.RateGroup_ID),t.xp6(1),t.hij("",e.RateGroup_Name," ")}}function Tt(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div")(1,"div",72)(2,"div",73)(3,"div",74)(4,"h5",75),t._uU(5,"Import Rate Group Items"),t.qZA(),t.TgZ(6,"button",76),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.closePopup())}),t.TgZ(7,"span",77),t._uU(8,"\xd7"),t.qZA()()(),t.TgZ(9,"div",78)(10,"div",9)(11,"label",1),t._uU(12,"Import items From:"),t.qZA(),t.TgZ(13,"div",11)(14,"select",79),t.NdJ("ngModelChange",function(r){t.CHM(e);const i=t.oxw();return t.KtG(i.importRateGroup=r)}),t.YNc(15,bt,2,2,"option",80),t.qZA()()()(),t.TgZ(16,"div",81)(17,"button",82),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.importRateClick())}),t._uU(18,"Import"),t.qZA()()()()()}if(2&n){const e=t.oxw();t.xp6(14),t.Q6J("ngModel",e.importRateGroup),t.xp6(1),t.Q6J("ngForOf",e.rategroupList)}}const At=[{path:"",component:P},{path:"add-rate-group",component:(()=>{class n{constructor(e,o,r,i,l,R,C,E){this.preventNavigationService=e,this.alertService=o,this.loadingService=r,this.masterService=i,this.router=l,this.activatedRoute=R,this.fb=C,this.rateGroupService=E,this.rateGroupObj={},this.enableTable=!1,this.gridPopupSettings=new Z.im,this.activerowIndex=0,this.mode="",this.disableOnView=!1,this.rategroupList=[],this.count=0,this.showPopup=!1,this.wsrateApply=!1,this.fileUploadPopupSettings=new N.s}handleKeyDownboardEvent(e){"F2"==e.code?(e.preventDefault(),this.uploadFilePopup()):"Escape"==e.code&&(e.preventDefault(),this.hideFileUploadPopup())}ngOnInit(){try{if(this.activatedRoute.snapshot.params.returnUrl&&(this.returnUrl=this.activatedRoute.snapshot.params.returnUrl),this.activatedRoute.snapshot.params.rateGroupID){let e=this.activatedRoute.snapshot.params.rateGroupID;this.loadingService.show("Getting Data, please wait..."),this.rateGroupService.getRateGroupByID(e).subscribe(o=>{if(this.loadingService.hide(),"ok"==o.status){let r=o.result.res,i=o.result.res1;console.log("ratemaster and detail",r,i),this.loadRateData(r,i),"edit"==this.activatedRoute.snapshot.params.mode?this.modeTitle="Edit Rate Group":"view"==this.activatedRoute.snapshot.params.mode&&(this.modeTitle="View Rate Group"),this.mode="edit"}else this.mode="",this.modeTitle="Edit- Error in Rate Group"},o=>{this.loadingService.hide(),this.mode="",this.modeTitle="Edit2 -Error in Loading data"})}else this.mode="add",this.modeTitle="Add Rate Group";this.activatedRoute.snapshot.params.mode&&"view"==this.activatedRoute.snapshot.params.mode&&(this.disableOnView=!0),this.rateGroupService.getRateGroupList().subscribe(e=>{e&&(console.log("Res",e),this.rategroupList=e||[])})}catch(e){this.alertService.error(e)}}loadRateData(e,o){this.rateGroupObj.RateGroup_ID=e.RateGroup_ID,this.rateGroupObj.RateGroup_Name=e.RateGroup_Name,this.rateGroupObj.RateGroup_Type=e.RateGroup_Type,this.rateGroupObj.Discontinued=1==e.Discontinued?1:0,this.rateGroupObj.Created=e.Created,this.rateGroupObj.CreatedBy=e.CreatedBy,this.rateGroupObj.ApplyWSRate=e.ApplyWSRate,this.enableTable=!0,this.flag=this.rateGroupObj.RateGroup_Type,this.rateGroupObj.RateGroup_Detail=o,"Mcode"==this.rateGroupObj.RateGroup_Type&&(console.log("ENTER"),this.rateGroupObj.RateGroup_Detail.forEach(r=>{1==this.rateGroupObj.ApplyWSRate?(r.RATE_EXVAT=r.RATE_B,r.RATE_INVAT=r.In_Rate_B):(r.RATE_EXVAT=r.RATE_A,r.RATE_INVAT=r.In_Rate_A),0!=r.Rate?this.calculateAfterRateApplyVIEW(r):0!=r.Amount&&this.calculateAfterAmountApplyVIEW(r)})),o[0].Rate?(console.log("hit RATE"),this.Offeron="rate",this.showRate=!0,this.showAmount=!1):o[0].Amount&&(this.Offeron="amount",this.showRate=!1,this.showAmount=!0)}ChangeRateType(e){this.disableOfferOn=!1,console.log("change rete",e),this.rateGroupObj.RateGroup_Detail=[],this.Offeron="rate",this.addRow(),"MCAT"==e?this.flag="MCAT":"MGroup"==e?this.flag="MGroup":"Mcode"==e?this.flag="Mcode":"Parent"==e&&(this.flag="Parent"),this.enableTable=!0,this.fileUploadPopupSettings=Object.assign(new N.s,{title:"Import Rate Group Master",uploadEndpoints:`/importExcelForRateGroupMaster/${this.rateGroupObj.RateGroup_Type}`,sampleFileUrl:`/downloadSampleExcelforMasterMigration?importName=${this.rateGroupObj.RateGroup_Type}`,allowMultiple:!1,acceptFormat:".xlsx",filename:this.rateGroupObj.RateGroup_Type+" Sample"})}addRow(){try{this.rateGroupObj.RateGroup_Detail.push({})}catch(o){console.log(o),alert(o)}}onEntryRate(e){console.log("rate changed",e,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].PRATE),0!=e?(this.rateentered=!0,document.getElementById("amount"+this.activerowIndex).setAttribute("disabled","disabled"),this.rateGroupObj.RateGroup_Detail[this.activerowIndex].Amount=0,this.calculateAfterRateApply(),this.rateGroupObj.RateGroup_Detail[this.activerowIndex].NEWRATE_EXCVAT<this.rateGroupObj.RateGroup_Detail[this.activerowIndex].PRATE&&(confirm("Sale rate of this item becomes less than its Purchse rate:"+this.rateGroupObj.RateGroup_Detail[this.activerowIndex].PRATE+".  Are you sure you want to contiue ? ")||(console.log("change"),this.rateGroupObj.RateGroup_Detail[this.activerowIndex].Rate=0,this.calculateAfterRateApply()))):(this.rateentered=!1,document.getElementById("amount"+this.activerowIndex).removeAttribute("disabled"))}onEntryAmount(e){0!=e?(document.getElementById("rate"+this.activerowIndex).setAttribute("disabled","disabled"),this.rateGroupObj.RateGroup_Detail[this.activerowIndex].Rate=0,this.calculateAfterAmountApply(),this.rateGroupObj.RateGroup_Detail[this.activerowIndex].NEWRATE_EXCVAT<this.rateGroupObj.RateGroup_Detail[this.activerowIndex].PRATE&&(confirm("Sale rate of this item becomes less than its Purchse rate:"+this.rateGroupObj.RateGroup_Detail[this.activerowIndex].PRATE+".  Are you sure you want to contiue ? ")||(this.rateGroupObj.RateGroup_Detail[this.activerowIndex].Amount=0,this.calculateAfterRateApply()))):document.getElementById("rate"+this.activerowIndex).removeAttribute("disabled")}calculateAfterRateApply(){let e=this.rateGroupObj.RateGroup_Detail[this.activerowIndex];e.NEWRATE_EXCVAT=Number(e.RATE_EXVAT+e.RATE_EXVAT*(e.Rate/100)),e.NEWRATE_INCVAT=Number(e.RATE_INVAT+e.RATE_INVAT*(e.Rate/100))}calculateAfterRateApplyVIEW(e){e.NEWRATE_EXCVAT=Number(e.RATE_EXVAT+e.RATE_EXVAT*(e.Rate/100)),e.NEWRATE_INCVAT=Number(e.RATE_INVAT+e.RATE_INVAT*(e.Rate/100))}calculateVAT(e,o,r){return 1==o?e/r:e}calculateAfterAmountApply(){let e=this.rateGroupObj.RateGroup_Detail[this.activerowIndex],o=e.RATE_INVAT+e.Amount,r=this.calculateVAT(o,e.VAT,this.masterService.userSetting.VatConRate);if(e.NEWRATE_EXCVAT=Number(r),0==o||o<0||0==r||r<0)return this.alertService.error("Please enter amount so that In Vat and Ex vat  is not 0 or less than 0"),e.NEWRATE_INCVAT=null,void(e.NEWRATE_EXCVAT=null);e.NEWRATE_INCVAT=Number(o)}calculateAfterAmountApplyVIEW(e){let o=e.RATE_INVAT+e.Amount,r=this.calculateVAT(o,e.VAT,this.masterService.userSetting.VatConRate);e.NEWRATE_EXCVAT=Number(r),e.NEWRATE_INCVAT=Number(o)}CatkeyEvent(e){this.PlistTitle="Category List",this.activerowIndex=e,this.disableOfferOn=!0,this.gridPopupSettings={title:"Category",apiEndpoints:"/getMenuitemPagedListForScheme/Category",defaultFilterIndex:0,columns:[{key:"MCAT",title:"Category",hidden:!1,noSearch:!1}]},this.genericGrid.show()}groupKeyEvent(e){console.log("group key event"),this.activerowIndex=e,this.disableOfferOn=!0,this.gridPopupSettings={title:"Group",apiEndpoints:"/getMenuitemPagedListForScheme/MGroup",defaultFilterIndex:0,columns:[{key:"MENUCODE",title:"MENU CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"NAME",hidden:!1,noSearch:!1}]},this.genericGrid.show()}parentKeyEvent(e){console.log("parent key event"),this.activerowIndex=e,this.disableOfferOn=!0,this.gridPopupSettings={title:"Parent",apiEndpoints:"/getMenuitemPagedListForScheme/Parent",defaultFilterIndex:0,columns:[{key:"MENUCODE",title:"MENU CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"NAME",hidden:!1,noSearch:!1},{key:"PARENT",title:"PARENT",hidden:!1,noSearch:!1}]},this.genericGrid.show()}itemKeyEvent(e){console.log("item ketevent"),this.activerowIndex=e,this.disableOfferOn=!0,this.gridPopupSettings={title:"Item list",apiEndpoints:"/getMenuitemPagedListForScheme/Item",defaultFilterIndex:1,columns:[{key:"MENUCODE",title:"MENU CODE",hidden:!1,noSearch:!1},{key:"DESCA",title:"NAME",hidden:!1,noSearch:!1},{key:"PARENT",title:"PARENT",hidden:!1,noSearch:!1}]},this.genericGrid.show()}nextRow(e){if(this.rateGroupObj.RateGroup_Detail[this.activerowIndex].Rate>100)return void this.alertService.warning("Enter rate within 100%");if("MCAT"==this.rateGroupObj.RateGroup_Type&&!this.rateGroupObj.RateGroup_Detail[this.activerowIndex].MCat)return void this.alertService.warning("Please enter category to proceed!!!");if("MCAT"!=this.rateGroupObj.RateGroup_Type&&!this.rateGroupObj.RateGroup_Detail[this.activerowIndex].MENUCODE)return void this.alertService.warning("Please enter item to proceed!!!");if(0==this.rateGroupObj.RateGroup_Detail[this.activerowIndex].Rate||null==this.rateGroupObj.RateGroup_Detail[this.activerowIndex].Rate)return document.getElementById("amount"+this.activerowIndex).focus(),void(this.amountEntered=!0);this.addRow();let o=this.activerowIndex+1;switch(this.flag){case"MCAT":setTimeout(()=>{document.getElementById("category"+o).focus()},200);break;case"MGroup":setTimeout(()=>{document.getElementById("groupCode"+o).focus()},200);break;case"Parent":setTimeout(()=>{document.getElementById("parentCode"+o).focus()},200);break;case"Mcode":setTimeout(()=>{document.getElementById("itemCode"+o).focus()},200)}}nextRowAmount(e){if(null==this.rateGroupObj.RateGroup_Detail[this.activerowIndex].NEWRATE_INCVAT)return;if("MCAT"==this.rateGroupObj.RateGroup_Type&&!this.rateGroupObj.RateGroup_Detail[this.activerowIndex].MCat)return void this.alertService.warning("Please enter category to proceed!!!");if("MCAT"!=this.rateGroupObj.RateGroup_Type&&!this.rateGroupObj.RateGroup_Detail[this.activerowIndex].MENUCODE)return void this.alertService.warning("Please enter item to proceed!!!");this.addRow();let o=this.activerowIndex+1;switch(this.flag){case"MCAT":setTimeout(()=>{document.getElementById("category"+o).focus()},200);break;case"MGroup":setTimeout(()=>{document.getElementById("groupCode"+o).focus()},200);break;case"Parent":setTimeout(()=>{document.getElementById("parentCode"+o).focus()},200);break;case"Mcode":setTimeout(()=>{document.getElementById("itemCode"+o).focus()},200)}}TableRowclick(e){this.activerowIndex=e}onSave(){try{if(null==this.rateGroupObj.RateGroup_Name||""==this.rateGroupObj.RateGroup_Name||null==this.rateGroupObj)return void this.alertService.warning("Rate Group Name is empty");if("Mcode"==this.rateGroupObj.RateGroup_Type&&null==this.rateGroupObj.RateGroup_Detail[this.activerowIndex].NEWRATE_INCVAT)return void this.alertService.warning("Inclusive Vat is empty");if(this.count=0,this.rateGroupObj.RateGroup_Detail.forEach(e=>{e.Rate>100&&this.count++}),this.count>0)return void this.alertService.warning("Enter Rate within limit of 100%");console.log("Rate Object save",this.rateGroupObj,this.rateGroupObj.RateGroup_Detail),this.removeInvalidRows(),this.submitSave()}catch(e){alert(e)}}exportClick(){let o_reportname=`${this.rateGroupObj.RateGroup_Name}`,r=this.rateGroupObj.RateGroup_Type,i=this.rateGroupObj.RateGroup_ID;this.loadingService.show("Excel file is downloading..Please wait"),this.rateGroupService.downloadRateGroupExcel(i,r).subscribe(l=>{this.loadingService.hide();let R=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});F.saveAs(R,`${o_reportname}.xlsx`)},l=>{this.loadingService.hide()})}submitSave(){this.loadingService.show("Saving Rate Group, Please Wait..."),this.rateGroupService.saveRateGroup(this.mode,this.rateGroupObj).subscribe(e=>{console.log("rate group save result",e),"ok"==e.status?(this.alertService.success("Scheme Saved Successfully !"),this.rateGroupObj={},this.rateGroupObj.RateGroup_Detail=[],this.router.navigate(["/pages/masters/rategroup"])):(this.loadingService.hide(),this.alertService.error(e.result.error))})}removeInvalidRows(){"MCAT"==this.rateGroupObj.RateGroup_Type?this.rateGroupObj.RateGroup_Detail=this.rateGroupObj.RateGroup_Detail.filter(e=>null!=e.MCat&&""!=e.MCat):"MGroup"==this.rateGroupObj.RateGroup_Type||"Mcode"==this.rateGroupObj.RateGroup_Type?this.rateGroupObj.RateGroup_Detail=this.rateGroupObj.RateGroup_Detail.filter(e=>null!=e.MENUCODE&&""!=e.MENUCODE):"Parent"==this.rateGroupObj.RateGroup_Type&&(this.rateGroupObj.RateGroup_Detail=this.rateGroupObj.RateGroup_Detail.filter(e=>null!=e.MCode&&""!=e.MCode))}cancel(){try{this.router.navigate(["./pages/masters/rategroup"])}catch(e){alert(e)}}dblClickPopupItem(e){switch(this.flag){case"Mcode":if(this.rateGroupObj.RateGroup_Detail.filter(r=>r.MENUCODE===e.MENUCODE).length>0)return void this.alertService.warning("Cannot enter duplicate item");this.rateGroupObj.RateGroup_Detail[this.activerowIndex].MENUCODE=e.MENUCODE,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].DESCA=e.DESCA,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].MCode=e.MCODE,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].Parent=e.PARENT,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].RATE_A=e.RATE_A,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].RATE_B=e.RATE_B,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].In_Rate_A=e.In_Rate_A,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].In_Rate_B=e.In_Rate_B,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].RATE_INVAT=1==this.wsrateApply?e.In_Rate_B:e.In_Rate_A,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].RATE_EXVAT=1==this.wsrateApply?e.RATE_B:e.RATE_A,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].PRATE=e.PRATE_A,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].VAT=e.VAT,this.focusToOffer();break;case"MCAT":if(this.rateGroupObj.RateGroup_Detail.filter(r=>r.MCat===e.MCAT).length>0)return void this.alertService.warning("Cannot enter duplicate Category");this.rateGroupObj.RateGroup_Detail[this.activerowIndex].MCat=e.MCAT,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].MCode=e.MCAT,this.focusToOffer();break;case"MGroup":if(this.rateGroupObj.RateGroup_Detail.filter(r=>r.MENUCODE===e.MENUCODE).length>0)return void this.alertService.warning("Cannot enter duplicate major group");this.rateGroupObj.RateGroup_Detail[this.activerowIndex].MENUCODE=e.MENUCODE,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].DESCA=e.DESCA,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].MCode=e.MCODE,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].Parent=e.PARENT,this.focusToOffer();break;case"Parent":if(this.rateGroupObj.RateGroup_Detail.filter(r=>r.Parent===e.PARENT).length>0)return void this.alertService.warning("Cannot enter duplicate Parent");this.rateGroupObj.RateGroup_Detail[this.activerowIndex].MENUCODE=e.MENUCODE,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].DESCA=e.DESCA,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].MCode=e.MCODE,this.rateGroupObj.RateGroup_Detail[this.activerowIndex].Parent=e.PARENT,this.focusToOffer()}}focusToOffer(){document.getElementById("rate"+this.activerowIndex).focus()}deleteRow(){confirm("Are you sure u you want to delete the Row?")&&(this.rateGroupObj.RateGroup_Detail.splice(this.activerowIndex,1),0===this.rateGroupObj.RateGroup_Detail.length&&this.addRow())}importRateClick(){console.log("import rate group id",this.importRateGroup);let e=String(this.importRateGroup);this.loadingService.show("Importing Data, please wait..."),this.rateGroupService.getRateGroupByID(e).subscribe(o=>{if(this.loadingService.hide(),"ok"==o.status){let r=o.result.res,i=o.result.res1;console.log("importing ratemaster ratedetail",r,i),this.rateGroupObj.RateGroup_Type=r.RateGroup_Type,this.enableTable=!0,this.flag=this.rateGroupObj.RateGroup_Type,this.rateGroupObj.RateGroup_Detail=i,i[0].Rate?(console.log("hit RATE"),this.Offeron="rate",this.showRate=!0,this.showAmount=!1):i[0].Amount&&(this.Offeron="amount",this.showRate=!1,this.showAmount=!0),this.rateGroupObj.RateGroup_Detail.forEach(l=>{l.Rate=null,l.Amount=null}),this.showPopup=!1}})}showImportPopup(){this.showPopup=!0}closePopup(){this.showPopup=!1}onApplyWSrate(e){console.log("onApplyWSRATE",e.target.checked,this.rateGroupObj.RateGroup_Detail.length),this.rateGroupObj.ApplyWSRate=e.target.checked?1:0,this.wsrateApply=e.target.checked,this.rateGroupObj.RateGroup_Detail.forEach(o=>{1==this.wsrateApply?(o.RATE_EXVAT=o.RATE_B,o.RATE_INVAT=o.In_Rate_B):(o.RATE_EXVAT=o.RATE_A,o.RATE_INVAT=o.In_Rate_A),0!=o.Rate?this.calculateAfterRateApplyVIEW(o):0!=o.Amount&&this.calculateAfterAmountApplyVIEW(o)})}showFileUploadPopup(){this.fileUploadPopup.show()}hideFileUploadPopup(){this.fileUploadPopup.hide()}uploadFilePopup(){this.rateGroupObj.RateGroup_Type?this.showFileUploadPopup():this.alertService.warning("Please Select Rate Group Type...")}fileUploadSuccess(e){"ok"==e.status&&(this.rateGroupObj.RateGroup_Detail=e.result,"Mcode"==this.rateGroupObj.RateGroup_Type&&this.rateGroupObj.RateGroup_Detail.forEach(o=>{1==this.rateGroupObj.ApplyWSRate?(o.RATE_EXVAT=o.RATE_B,o.RATE_INVAT=o.In_Rate_B):(o.RATE_EXVAT=o.RATE_A,o.RATE_INVAT=o.In_Rate_A),0!=o.Rate?this.calculateAfterRateApplyVIEW(o):0!=o.Amount&&this.calculateAfterAmountApplyVIEW(o)}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(U.d),t.Y36(s.c),t.Y36(k.V),t.Y36(O.P),t.Y36(c.F0),t.Y36(c.gz),t.Y36(g.qu),t.Y36(M))},n.\u0275cmp=t.Xpm({type:n,selectors:[["rategroup-form"]],viewQuery:function(e,o){if(1&e&&(t.Gf(J,5),t.Gf(L,5)),2&e){let r;t.iGM(r=t.CRH())&&(o.genericGrid=r.first),t.iGM(r=t.CRH())&&(o.fileUploadPopup=r.first)}},hostBindings:function(e,o){1&e&&t.NdJ("keydown",function(i){return o.handleKeyDownboardEvent(i)},!1,t.evT)},decls:49,vars:15,consts:[[1,"sticky-top","row"],[1,"col-md-4"],[1,"col-md-8"],[1,"row","pull-right","mx-2"],["type","button","class","btn btn-info btn-sm",3,"click",4,"ngIf"],["type","submit",1,"btn","btn-info","btn-sm",3,"disabled","click"],["type","button",1,"btn","btn-info","btn-sm",3,"click"],[1,"row","plainBackGround",2,"margin-top","0.5rem","padding-top","1rem"],[1,"col-md-5"],[1,"form-group","row"],[1,"col-md-4","form-control-label"],[1,"col-md-6"],["type","text",1,"form-control",3,"ngModel","disabled","ngModelChange"],[3,"ngModel","disabled","ngModelChange"],["value","MGroup"],["value","Mcode"],["value","Parent"],["value","MCAT"],["name","discontinue","id","discontinue",3,"ngModel","disabled","ngModelChange"],["value","0"],["value","1"],["class","form-group-row",4,"ngIf"],["class","row","style","margin-left:10px; margin-right:0px;background:white; color: #666666;  background-color: #ffffff; border: 0; border-radius: 5px; position: relative;   box-shadow:0 5px 5px 0 rgba(0, 0, 0, 0.25);height: 65vh;",4,"ngIf"],[3,"popupsettings","onItemDoubleClick"],["genericGrid",""],[4,"ngIf"],[3,"popupsettings","onUploaded"],["fileUploadPopup",""],[1,"form-group-row"],["type","checkbox",2,"height","16px","width","48px",3,"ngModel","ngModelChange","change"],[1,"row",2,"margin-left","10px","margin-right","0px","background","white","color","#666666","background-color","#ffffff","border","0","border-radius","5px","position","relative","box-shadow","0 5px 5px 0 rgba(0, 0, 0, 0.25)","height","65vh"],["class","col-md-12 row","style","position: relative;top: 1rem;",4,"ngIf"],[1,"row"],[1,"col-md-12",2,"margin-top","5px"],[1,"col-md-3","form-control-label",2,"font-weight","bold"],[1,"col-md-8","row"],["type","search","placeholder","Search...","name","filters","autocomplete","off",1,"form-control",2,"height","1.5rem","font-size","13px","margin-top","7px",3,"ngModel","ngModelChange"],[1,"col-md-12","row"],[1,"col-md-12",2,"height","55vh","overflow-y","scroll","overflow-x","hidden"],[1,"table"],["style"," border-top: 2px solid #E6E6E6;    height: 30px;\n                    background:#9ccae4;\n                    color: black;",4,"ngIf"],[2,"border-bottom","2px solid #E6E6E6","border-top","1px solid #E6E6E6","height","30px","background","#9ccae4","color","black","font-size","15px"],["scope","col",2,"width","4%"],["scope","col","style","width: 15rem;",4,"ngIf"],["scope","col","style","width: 20rem;",4,"ngIf"],["scope","col","style","width: 10rem;text-align: center;",4,"ngIf"],["scope","col",2,"width","10rem","text-align","center"],[2,"background-color","aliceblue"],["style","height: 28px;",3,"click","keydown.Shift.delete",4,"ngFor","ngForOf"],[1,"col-md-12","row",2,"position","relative","top","1rem"],[1,"col-md-6","pd0"],[1,"col-md-6","pd0","row",2,"font-size","14px"],[2,"border-top","2px solid #E6E6E6","height","30px","background","#9ccae4","color","black"],["scope","col","colspan","2",2,"width","20rem","text-align","center"],["scope","col","colspan","2",2,"text-align","center"],["scope","col",2,"width","15rem"],["scope","col",2,"width","20rem"],[2,"height","28px",3,"click","keydown.Shift.delete"],[1,"TableRowSize",2,"width","4%",3,"id"],["style","width: 3rem;text-align: center;","class","TableRowSize",4,"ngIf"],["style","width: 3rem;","class","TableRowSize",4,"ngIf"],["style","width: 3rem;text-align: right;","class","TableRowSize",4,"ngIf"],["style","width: 3rem; text-align: right;","class","TableRowSize",4,"ngIf"],[1,"TableRowSize",2,"width","3rem","text-align","center"],["type","number","placeholder","Enter Rate",2,"width","95%",3,"ngModel","id","disabled","ngModelChange","keydown.enter","keydown.Tab"],["type","number","placeholder","Enter Amount",2,"width","95%",3,"ngModel","id","disabled","ngModelChange","keydown.enter","keydown.Tab"],["type","text","placeholder","Press Enter to select Category","autocomplete","off",2,"width","95%",3,"id","ngModel","disabled","ngModelChange","keydown.Tab","keydown.enter"],["type","text","placeholder","Press Enter to select Group","autocomplete","off",2,"width","95%",3,"id","ngModel","disabled","ngModelChange","keydown.Tab","keydown.enter"],[1,"TableRowSize",2,"width","3rem"],["type","text","placeholder","Press Enter to select Parent","autocomplete","off",2,"width","95%",3,"id","ngModel","disabled","ngModelChange","keydown.Tab","keydown.enter"],["type","text","placeholder","Press Enter to select Item","autocomplete","off",2,"width","95%",3,"id","ngModel","disabled","ngModelChange","keydown.Tab","keydown.enter"],[1,"TableRowSize",2,"width","3rem","text-align","right"],[1,"modal-sticky",2,"display","block","padding","0px","margin-bottom","31px","margin-right","-5rem"],[1,"modal-content","modal-content-main-area",2,"width","70%"],[1,"modal-header",2,"padding","0px","background","#c0c0c0"],[1,"modal-title",2,"padding-left","5px"],["aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"form-control",2,"padding","0px 5px",3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"btn","btn-info","btn-sm",2,"position","relative",3,"click"],[3,"ngValue"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h5"),t._uU(3),t.qZA()(),t.TgZ(4,"div",2)(5,"div",3),t.YNc(6,V,2,0,"button",4),t.TgZ(7,"button",5),t.NdJ("click",function(){return o.onSave()}),t._uU(8,"Save"),t.qZA(),t.TgZ(9,"button",6),t.NdJ("click",function(){return o.cancel()}),t._uU(10,"Reset"),t.qZA(),t.YNc(11,B,2,0,"button",4),t.qZA()()(),t.TgZ(12,"div",7)(13,"div",8)(14,"div",9)(15,"label",10),t._uU(16,"Rate Group Name:"),t.qZA(),t.TgZ(17,"div",11)(18,"input",12),t.NdJ("ngModelChange",function(i){return o.rateGroupObj.RateGroup_Name=i}),t.qZA()()(),t.TgZ(19,"div",9)(20,"label",10),t._uU(21,"Rate Group Type:"),t.qZA(),t.TgZ(22,"div",11)(23,"select",13),t.NdJ("ngModelChange",function(i){return o.rateGroupObj.RateGroup_Type=i})("ngModelChange",function(){return o.ChangeRateType(o.rateGroupObj.RateGroup_Type)}),t.TgZ(24,"option",14),t._uU(25," Major Group"),t.qZA(),t.TgZ(26,"option",15),t._uU(27," Product"),t.qZA(),t.TgZ(28,"option",16),t._uU(29," Group"),t.qZA(),t.TgZ(30,"option",17),t._uU(31," Category"),t.qZA()()()(),t.TgZ(32,"div",9)(33,"label",10),t._uU(34,"Discontinue: "),t.qZA(),t.TgZ(35,"div",11)(36,"select",18),t.NdJ("ngModelChange",function(i){return o.rateGroupObj.Discontinued=i}),t.TgZ(37,"option",19),t._uU(38,"Is Active"),t.qZA(),t.TgZ(39,"option",20),t._uU(40,"Is Not Active"),t.qZA()()()(),t.YNc(41,q,4,1,"div",21),t.qZA(),t._UZ(42,"div",11),t.qZA(),t.YNc(43,Gt,35,18,"div",22),t.TgZ(44,"generic-popup-grid",23,24),t.NdJ("onItemDoubleClick",function(i){return o.dblClickPopupItem(i)}),t.qZA(),t.YNc(46,Tt,19,2,"div",25),t.TgZ(47,"file-uploader-popup",26,27),t.NdJ("onUploaded",function(i){return o.fileUploadSuccess(i)}),t.qZA()),2&e&&(t.xp6(3),t.Oqu(o.modeTitle),t.xp6(3),t.Q6J("ngIf",1==o.disableOnView),t.xp6(1),t.Q6J("disabled",o.disableOnView),t.xp6(4),t.Q6J("ngIf",1!=o.disableOnView),t.xp6(7),t.Q6J("ngModel",o.rateGroupObj.RateGroup_Name)("disabled",o.disableOnView),t.xp6(5),t.Q6J("ngModel",o.rateGroupObj.RateGroup_Type)("disabled",o.disableOnView),t.xp6(13),t.Q6J("ngModel",o.rateGroupObj.Discontinued)("disabled",o.disableOnView),t.xp6(5),t.Q6J("ngIf",1==o.masterService.userSetting.ENABLEWSALESRATEBILLING&&"MCAT"!=o.flag),t.xp6(2),t.Q6J("ngIf",o.enableTable),t.xp6(1),t.Q6J("popupsettings",o.gridPopupSettings),t.xp6(2),t.Q6J("ngIf",o.showPopup),t.xp6(1),t.Q6J("popupsettings",o.fileUploadPopupSettings))},dependencies:[m.sg,m.O5,g.YN,g.Kr,g.Fj,g.wV,g.Wl,g.EJ,g.JJ,g.On,Z.Zl,N.U,m.JJ,y],styles:["input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{border:1px solid #cbcbcb;border-radius:3px;height:3.5vh;color:#000;width:100%}label[_ngcontent-%COMP%]{height:25px;font-size:13px}.form-group[_ngcontent-%COMP%]{margin-bottom:.5rem}.form-control[_ngcontent-%COMP%]{font-size:13px}th[_ngcontent-%COMP%]{padding:2px}td[_ngcontent-%COMP%]{padding:3px}.TableRowSize[_ngcontent-%COMP%]{height:23px;border:1px solid #e6e6e6}"]}),n})()}];let Ct=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[c.Bz.forChild(At),c.Bz]}),n})();var xt=p(55618);const vt={suppressScrollX:!1};let wt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[M,{provide:G.op,useValue:vt}],imports:[m.ez,b.m,Ct,T.JX,G.Xd,f.zk.forRoot(),d.Is,v.b.forRoot(),xt.c.forRoot()]}),n})()}}]);