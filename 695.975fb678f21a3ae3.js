"use strict";(self.webpackChunkimserp=self.webpackChunkimserp||[]).push([[695],{70695:(H,C,a)=>{a.r(C),a.d(C,{PaymentCollectionModule:()=>U});var u=a(88692),h=a(7976),e=a(64537);let v=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["payment"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[h.lC],encapsulation:2}),o})();var b=a(19102),y=a(28698),A=a(14970),x=a(53074),w=a(67311),g=a(54536),_=a(79765),M=a(35732),T=a(67297),E=a(71180);let P=(()=>{class o{constructor(t,n,i){this.http=t,this.authService=n,this.state=i;const r=this.state.getGlobalSetting("apiUrl");r&&r.length>0&&(this.apiUrl=r)}savePaymentCollection(t){let n={status:"error",result:""},i=new _.xQ;const r={headers:this.authService.getRequestOption(),method:"post"};return this.http.post(this.apiUrl+"/savePaymentCollection",t,r).subscribe(l=>{i.next(l),i.unsubscribe()},l=>{n.status="error",n.result=l,i.next(n),i.unsubscribe()}),i}GetViewPaymentCollectionVoucher(t,n,i,r="",l=""){let m={status:"error",result:""},c=new _.xQ;return this.http.get(this.apiUrl+`/GetViewPaymentCollectionVoucher?collectionMode=${t}&mode=${n}&receiveDate=${i}&ACID=${r}&VCHRNO=${l}`).subscribe(p=>{c.next(p),c.unsubscribe()},p=>{m.status="error",m.result=p,c.next(m),c.unsubscribe()}),c}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(M.eN),e.LFG(T.e),e.LFG(E.q))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac}),o})();var d=a(20092);const I=["genericGridACList"],k=["genericGridAccountList"],S=["genericGridPaymentView"],Z=["genericGridPaymentEdit"];function N(o,s){if(1&o&&(e.TgZ(0,"h5",27),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("Payment Entry Form [ ",t.Mode," ]")}}function G(o,s){if(1&o&&(e.TgZ(0,"h5",27),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij("Receipt Entry Form [ ",t.Mode," ]")}}function O(o,s){1&o&&(e.TgZ(0,"th",19),e._uU(1," Amount"),e.qZA())}function L(o,s){1&o&&(e.TgZ(0,"th",19),e._uU(1,"Payment Mode"),e.qZA())}function R(o,s){1&o&&(e.TgZ(0,"th",19),e._uU(1," Amount"),e.qZA())}function j(o,s){1&o&&(e.TgZ(0,"th",19),e._uU(1,"Receipt Mode"),e.qZA())}function D(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"tr",28),e.NdJ("click",function(){const r=e.CHM(t).index,l=e.oxw();return e.KtG(l.rowClick(r))})("keydown.Shift.delete",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.deleteRow())}),e.TgZ(1,"td",29),e._uU(2),e.qZA(),e.TgZ(3,"td",30)(4,"input",31),e.NdJ("keydown.enter",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.CustomerList())})("ngModelChange",function(i){const l=e.CHM(t).$implicit;return e.KtG(l.ACCNAME=i)}),e.qZA()(),e.TgZ(5,"td",30)(6,"input",32),e.NdJ("ngModelChange",function(i){const l=e.CHM(t).$implicit;return e.KtG(l.Amount=i)})("keydown.enter",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.FocusControl2())}),e.qZA()(),e.TgZ(7,"td",30)(8,"select",33),e.NdJ("change",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.ClearCheque())})("ngModelChange",function(i){const l=e.CHM(t).$implicit;return e.KtG(l.Paymentmode=i)})("keydown.enter",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.FocusControl())}),e.TgZ(9,"option",34),e._uU(10,"Cash"),e.qZA(),e.TgZ(11,"option",35),e._uU(12,"Cheque"),e.qZA(),e.TgZ(13,"option",36),e._uU(14,"Credit Card"),e.qZA(),e.TgZ(15,"option",37),e._uU(16,"E-Payment"),e.qZA()()(),e.TgZ(17,"td",30)(18,"input",38),e.NdJ("ngModelChange",function(i){const l=e.CHM(t).$implicit;return e.KtG(l.ChequeNo=i)})("keydown.enter",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.FocusControl1())}),e.qZA()(),e.TgZ(19,"td",30)(20,"input",39),e.NdJ("ngModelChange",function(i){const l=e.CHM(t).$implicit;return e.KtG(l.ChequeDate=i)})("keydown.enter",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.FocusControl3())}),e.qZA()(),e.TgZ(21,"td",30)(22,"input",40),e.NdJ("keydown.enter",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.AccountList())})("ngModelChange",function(i){const l=e.CHM(t).$implicit;return e.KtG(l.TRNACCNAME=i)}),e.qZA()(),e.TgZ(23,"td",30)(24,"input",41),e.NdJ("ngModelChange",function(i){const l=e.CHM(t).$implicit;return e.KtG(l.Remarks=i)})("keydown.enter",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.addRow())}),e.qZA()()()}if(2&o){const t=s.$implicit,n=s.index,i=e.oxw();e.xp6(1),e.Q6J("disabled","VIEW"==i.Mode),e.xp6(1),e.Oqu(n+1),e.xp6(2),e.MGl("id","partyname",n,""),e.Q6J("ngModel",t.ACCNAME)("disabled","VIEW"==i.Mode),e.xp6(2),e.MGl("id","amount",n,""),e.Q6J("ngModel",t.Amount)("disabled","VIEW"==i.Mode),e.xp6(2),e.MGl("id","mode",n,""),e.Q6J("ngModel",t.Paymentmode)("disabled","VIEW"==i.Mode),e.xp6(10),e.MGl("id","chequeno",n,""),e.Q6J("disabled","cash"==t.Paymentmode||"credit"==t.Paymentmode||"VIEW"==i.Mode)("ngModel",t.ChequeNo),e.xp6(2),e.MGl("id","chequedate",n,""),e.Q6J("disabled","cash"==t.Paymentmode||"credit"==t.Paymentmode||"VIEW"==i.Mode)("ngModel",t.ChequeDate),e.xp6(2),e.MGl("id","tranaccnt",n,""),e.Q6J("ngModel",t.TRNACCNAME)("disabled","VIEW"==i.Mode),e.xp6(2),e.MGl("id","remarks",n,""),e.Q6J("ngModel",t.Remarks)("disabled","VIEW"==i.Mode)}}let f=(()=>{class o{constructor(t,n,i,r,l,m,c){this.loadingService=t,this.masterService=n,this.alertService=i,this.router=r,this.arouter=l,this.dialog=m,this.paymentColService=c,this.activerowIndex=0,this.disableOnSave=!0,this.currentPage=1,this.PaymentObj={},this.Mode="NEW",this.gridACListPopupSettings=new y.im,this.gridAccountListPopupSettings=new b.sG,this.genericGridPaymentViewSettings=new y.im,this.genericGridPaymentEditSettings=new y.im,this.activeurlpath=l.snapshot.url[0].path}ngOnInit(){this.PaymentObj.Mode="NEW",this.Reset(),this.getCurrentDate()}rowClick(t){this.activerowIndex=t}addRow(){if(""!=this.PaymentObj.paymentList[this.activerowIndex].TRNACCNAME&&null!=this.PaymentObj.paymentList[this.activerowIndex].TRNACCNAME&&null!=this.PaymentObj.paymentList[this.activerowIndex].TRNACCNAME){if(null==this.PaymentObj.paymentList&&(this.PaymentObj.paymentList=[]),console.log("HERE",this.PaymentObj.paymentList),this.PaymentObj.paymentList.push({}),this.PaymentObj.paymentList.length>0){let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("partyname"+n).focus(),document.getElementById("partyname"+n).click()},50)}}else this.alertService.warning("Please insert the Account.")}getCurrentDate(){const t=new Date;this.currDate=(0,u.p6)(t,"yyyy-MM-dd","en-US"),this.PaymentObj.Date=this.currDate}Reset(){this.Mode="NEW",this.PaymentObj.Mode="NEW",this.PaymentObj={},this.PaymentObj.paymentList=[],this.PaymentObj={},null==this.PaymentObj.paymentList&&(this.PaymentObj.paymentList=[]);try{this.PaymentObj.paymentList.push({})}catch(i){console.log(i),alert(i)}let n=this.activerowIndex+1;setTimeout(()=>{document.getElementById("partyname"+n).focus()},50),this.getCurrentDate(),this.currentPage=1,this.ListPagination(this.currentPage)}cancel(){console.log("@@returnUrl");try{this.router.navigate(["/pages/dashboard"])}catch(t){console.log(t),this.alertService.error(t)}}onSave(){this.loadingService.show("Saving, Please Wait..."),this.PaymentObj.CollectionMode="receipt-entry"==this.activeurlpath?"RECEIPT":"PAYMENT";try{this.removeInvalidRows(),this.submitSave()}catch(t){alert(t)}}submitSave(){this.PaymentObj.Mode=this.Mode,this.paymentColService.savePaymentCollection(this.PaymentObj).subscribe(t=>{console.log("Payment",t),"ok"==t.status?(this.loadingService.hide(),this.alertService.success(t.result),this.Reset()):(this.loadingService.hide(),this.alertService.error(t.result))},t=>{console.log("error",t),this.alertService.error(t)}),console.log("SAVE Payment",this.PaymentObj)}removeInvalidRows(){this.PaymentObj.paymentList=this.PaymentObj.paymentList.filter(t=>null!=t.ACID&&""!=t.ACID),this.PaymentObj.paymentList=this.PaymentObj.paymentList.filter(t=>null!=t.TRNACID&&""!=t.TRNACID)}ListPagination(t){console.log("event ma k aaucha",t),this.currentPage=t}CustomerList(){let t;console.log("Hellya"),t="receipt-entry"==this.activeurlpath?"receipt":"payment",this.gridACListPopupSettings={title:"Accounts",apiEndpoints:`/getPaymentReceiptAccountList/${t}`,defaultFilterIndex:1,columns:[{key:"ACID",title:"AC CODE",hidden:!1,noSearch:!1},{key:"ACNAME",title:"A/C NAME",hidden:!1,noSearch:!1}]},console.log("GRID",this.genericGridACList),this.genericGridACList.show()}AccountList(){let t,n=this.PaymentObj.paymentList[this.activerowIndex];"receipt-entry"==this.activeurlpath?t="cash"==n.Paymentmode||"credit"==n.Paymentmode?"all":"bank":(t="cash"==n.Paymentmode?"all":"bank",t="payment"),this.gridAccountListPopupSettings={title:"Accounts",apiEndpoints:`/getPaymentReceiptCashBankList/${t}`,defaultFilterIndex:1,columns:[{key:"ACID",title:"AC CODE",hidden:!1,noSearch:!1},{key:"ACNAME",title:"AC NAME",hidden:!1,noSearch:!1}]},this.genericGridAccountList.show()}onCustomerSelected(t){console.log("on cust selected",t),this.PaymentObj.paymentList[this.activerowIndex].ACCNAME=t.ACNAME,this.PaymentObj.paymentList[this.activerowIndex].ACID=t.ACID,this.masterService.focusAnyControl("amount"+this.activerowIndex)}onAccountselected(t){console.log("on ac sleected",t),this.PaymentObj.paymentList[this.activerowIndex].TRNACCNAME=t.ACNAME,this.PaymentObj.paymentList[this.activerowIndex].TRNACID=t.ACID,this.masterService.focusAnyControl("remarks"+this.activerowIndex)}View(){let t="",n="";"receipt-entry"==this.activeurlpath&&(t="RECEIPT VOUCHER",n="RECEIPT"),"payment-collection"==this.activeurlpath&&(t="PAYMENT VOUCHER",n="PAYMENT"),this.genericGridPaymentViewSettings={title:t,apiEndpoints:`/getViewPaymentCollectionPagedlist/${n}`,defaultFilterIndex:1,columns:[{key:"ReceiveDate",title:"Date",hidden:!1,noSearch:!1,format:!0},{key:"Amount",title:"Total Amount",hidden:!1,noSearch:!1,alignment:"right"}]},this.genericGridPaymentView.show()}onViewSelected(t){this.Mode="VIEW";let n="";"receipt-entry"==this.activeurlpath&&(n="RECEIPT"),"payment-collection"==this.activeurlpath&&(n="PAYMENT"),console.log("on view",t);let i=t.ReceiveDate.toString().substring(0,10);this.paymentColService.GetViewPaymentCollectionVoucher(n,"view",i).subscribe(r=>{console.log("res",r),"ok"==r.status?(this.PaymentObj.paymentList=r.result,this.PaymentObj.paymentList.forEach(l=>{l.ChequeDate=l.ChequeDate?l.ChequeDate.toString().substring(0,10):""})):this.PaymentObj.paymentList=[]},r=>{this.alertService.error(r)})}onEditclicked(){let t="",n="";"receipt-entry"==this.activeurlpath&&(t="RECEIPT VOUCHER",n="RECEIPT"),"payment-collection"==this.activeurlpath&&(t="PAYMENT VOUCHER",n="PAYMENT"),this.genericGridPaymentEditSettings={title:t,apiEndpoints:`/getPaymentCollectionPagedlistForEdit/${n}`,defaultFilterIndex:1,columns:[{key:"customerName",title:"Customer Name",hidden:!1,noSearch:!1},{key:"ReceiveDate",title:"Date",hidden:!1,noSearch:!1,format:!0},{key:"VCHRNO",title:"voucher no.",hidden:!1,noSearch:!1,alignment:"right"}]},this.genericGridPaymentEdit.show()}onEditSelected(t){console.log("on edit select",t),this.Mode="EDIT";let n="";"receipt-entry"==this.activeurlpath&&(n="RECEIPT"),"payment-collection"==this.activeurlpath&&(n="PAYMENT"),console.log("on view",t);let i=t.ReceiveDate.toString().substring(0,10);this.paymentColService.GetViewPaymentCollectionVoucher(n,"edit",i,t.ACID,t.VCHRNO).subscribe(r=>{console.log("res",r),"ok"==r.status?(this.PaymentObj.paymentList=r.result,this.PaymentObj.paymentList.forEach(l=>{l.ChequeDate=l.ChequeDate?l.ChequeDate.toString().substring(0,10):""})):this.PaymentObj.paymentList=[]},r=>{this.alertService.error(r)})}FocusControl(){this.masterService.focusAnyControl("cash"==this.PaymentObj.paymentList[this.activerowIndex].Paymentmode||"credit"==this.PaymentObj.paymentList[this.activerowIndex].Paymentmode?"tranaccnt"+this.activerowIndex:"chequeno"+this.activerowIndex)}FocusControl1(){this.masterService.focusAnyControl("chequedate"+this.activerowIndex)}FocusControl2(){console.log("Active",this.activerowIndex),this.masterService.focusAnyControl("mode"+this.activerowIndex)}FocusControl3(){console.log("Active",this.activerowIndex),this.masterService.focusAnyControl("tranaccnt"+this.activerowIndex)}ClearCheque(){this.PaymentObj.paymentList[this.activerowIndex].ChequeDate="",this.PaymentObj.paymentList[this.activerowIndex].ChequeNo=""}deleteRow(){confirm("Are you sure you want to delete the Row? ")&&(this.PaymentObj.paymentList.splice(this.activerowIndex,1),console.log("LENGTH",this.PaymentObj.paymentList.length),0===this.PaymentObj.paymentList.length&&this.Reset())}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(A.V),e.Y36(x.P),e.Y36(w.c),e.Y36(h.F0),e.Y36(h.gz),e.Y36(g.uw),e.Y36(P))},o.\u0275cmp=e.Xpm({type:o,selectors:[["payment-collection"]],viewQuery:function(t,n){if(1&t&&(e.Gf(I,5),e.Gf(k,5),e.Gf(S,5),e.Gf(Z,5)),2&t){let i;e.iGM(i=e.CRH())&&(n.genericGridACList=i.first),e.iGM(i=e.CRH())&&(n.genericGridAccountList=i.first),e.iGM(i=e.CRH())&&(n.genericGridPaymentView=i.first),e.iGM(i=e.CRH())&&(n.genericGridPaymentEdit=i.first)}},decls:54,vars:13,consts:[[1,"sticky-top"],[1,"row","clearfix"],[1,"col-md-6","pd0"],["style","color: black;",4,"ngIf"],[1,"col-md-6",2,"margin-left","-1.5%"],[1,"row","pull-right"],["type","submit",1,"btn","btn-info","btn-sm",3,"click"],["type","button",1,"btn","btn-info","btn-sm",3,"click"],[1,"row","plainBackGround",2,"margin-top","0.5rem"],[1,"row"],[2,"width","108px"],["type","date","autocomplete","off",2,"width","45%","height","24px","margin-left","23px","margin-top","4px",3,"ngModel","disabled","ngModelChange"],[2,"margin-top","10px"],[2,"height","48vh","overflow-y","scroll"],[2,"margin-bottom","5px","font-size","12px","width","98%","margin-left","10px"],[2,"border-bottom","2px solid #e6e6e6","border-top","2px solid #e6e6e6","height","30px","background","#9ccae4","color","black"],[2,"width","2%","font-size","12px"],["scope","col",2,"text-align","center","font-size","12px","width","15%"],["scope","col","style","text-align: center; font-size: 12px; width: 9%;",4,"ngIf"],["scope","col",2,"text-align","center","font-size","12px","width","9%"],[2,"overflow","scroll"],["style","border: 1px; max-height: 25px;",3,"click","keydown.Shift.delete",4,"ngFor","ngForOf"],[3,"popupsettings","onItemDoubleClick"],["genericGridACList",""],["genericGridAccountList",""],["genericGridPaymentView",""],["genericGridPaymentEdit",""],[2,"color","black"],[2,"border","1px","max-height","25px",3,"click","keydown.Shift.delete"],[2,"line-height","21px","text-align","center","border","1px solid #e6e6e6",3,"disabled"],[2,"line-height","21px","text-align","center","border","1px solid #e6e6e6"],["type","text","placeholder","Enter Customer Name","readonly","",2,"height","25px","width","100% !important",3,"id","ngModel","disabled","keydown.enter","ngModelChange"],["type","text",2,"width","100%",3,"id","ngModel","disabled","ngModelChange","keydown.enter"],["name","collectionmode",2,"width","120px","height","25px",3,"id","ngModel","disabled","change","ngModelChange","keydown.enter"],["value","cash"],["value","cheque"],["value","credit"],["value","qr"],["type","text",2,"width","100%","text-align","center",3,"id","disabled","ngModel","ngModelChange","keydown.enter"],["type","date",2,"width","100%","text-align","center",3,"id","disabled","ngModel","ngModelChange","keydown.enter"],["type","text","placeholder","Enter Account","readonly","",2,"width","100%","text-align","center",3,"id","ngModel","disabled","keydown.enter","ngModelChange"],[2,"width","100%",3,"id","ngModel","disabled","ngModelChange","keydown.enter"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e.YNc(3,N,2,1,"h5",3),e.YNc(4,G,2,1,"h5",3),e.qZA(),e.TgZ(5,"div",4)(6,"div",5)(7,"button",6),e.NdJ("click",function(){return n.Reset()}),e._uU(8,"Reset "),e.qZA(),e.TgZ(9,"button",7),e.NdJ("click",function(){return n.View()}),e._uU(10,"View"),e.qZA(),e.TgZ(11,"button",7),e.NdJ("click",function(){return n.onEditclicked()}),e._uU(12,"Edit"),e.qZA(),e.TgZ(13,"button",6),e.NdJ("click",function(){return n.onSave()}),e._uU(14,"Save "),e.qZA(),e.TgZ(15,"button",6),e.NdJ("click",function(){return n.cancel()}),e._uU(16,"Back"),e.qZA()()()()(),e.TgZ(17,"div",8)(18,"div",9)(19,"label",10),e._uU(20,"Date:"),e.qZA(),e.TgZ(21,"input",11),e.NdJ("ngModelChange",function(r){return n.PaymentObj.Date=r}),e.qZA()()(),e.TgZ(22,"div")(23,"div",12)(24,"div",13)(25,"table",14)(26,"thead")(27,"tr",15)(28,"th",16),e._uU(29,"SNo."),e.qZA(),e.TgZ(30,"th",17),e._uU(31,"Customer Name"),e.qZA(),e.YNc(32,O,2,0,"th",18),e.YNc(33,L,2,0,"th",18),e.YNc(34,R,2,0,"th",18),e.YNc(35,j,2,0,"th",18),e.TgZ(36,"th",19),e._uU(37,"ChequeNo/Transaction ID"),e.qZA(),e.TgZ(38,"th",19),e._uU(39,"ChequeDate"),e.qZA(),e.TgZ(40,"th",19),e._uU(41,"Account"),e.qZA(),e.TgZ(42,"th",19),e._uU(43,"Remarks"),e.qZA()()(),e.TgZ(44,"tbody",20),e.YNc(45,D,25,23,"tr",21),e.qZA()()()()(),e.TgZ(46,"generic-popup-grid",22,23),e.NdJ("onItemDoubleClick",function(r){return n.onCustomerSelected(r)}),e.qZA(),e.TgZ(48,"generic-popup-grid",22,24),e.NdJ("onItemDoubleClick",function(r){return n.onAccountselected(r)}),e.qZA(),e.TgZ(50,"generic-popup-grid",22,25),e.NdJ("onItemDoubleClick",function(r){return n.onViewSelected(r)}),e.qZA(),e.TgZ(52,"generic-popup-grid",22,26),e.NdJ("onItemDoubleClick",function(r){return n.onEditSelected(r)}),e.qZA()),2&t&&(e.xp6(3),e.Q6J("ngIf","payment-collection"==n.activeurlpath),e.xp6(1),e.Q6J("ngIf","receipt-entry"==n.activeurlpath),e.xp6(17),e.Q6J("ngModel",n.PaymentObj.Date)("disabled","VIEW"==n.Mode),e.xp6(11),e.Q6J("ngIf","payment-collection"==n.activeurlpath),e.xp6(1),e.Q6J("ngIf","payment-collection"==n.activeurlpath),e.xp6(1),e.Q6J("ngIf","receipt-entry"==n.activeurlpath),e.xp6(1),e.Q6J("ngIf","receipt-entry"==n.activeurlpath),e.xp6(10),e.Q6J("ngForOf",n.PaymentObj.paymentList),e.xp6(1),e.Q6J("popupsettings",n.gridACListPopupSettings),e.xp6(2),e.Q6J("popupsettings",n.gridAccountListPopupSettings),e.xp6(2),e.Q6J("popupsettings",n.genericGridPaymentViewSettings),e.xp6(2),e.Q6J("popupsettings",n.genericGridPaymentEditSettings))},dependencies:[u.sg,u.O5,d.YN,d.Kr,d.Fj,d.EJ,d.JJ,d.On,y.Zl]}),o})();const J=h.Bz.forChild([{path:"",component:v,children:[{path:"payment-collection",component:f},{path:"receipt-entry",component:f}]}]);var V=a(63321);let U=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[P],imports:[u.ez,J,d.u5,V._.forRoot(),g.Is]}),o})()}}]);